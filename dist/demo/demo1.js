!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("quill")):"function"==typeof define&&define.amd?define(["quill"],t):"object"==typeof exports?exports.quillBetterTable=t(require("quill")):e.quillBetterTable=t(e.Quill)}(window,function(e){return function(e){var t=window.webpackHotUpdatequillBetterTable;window.webpackHotUpdatequillBetterTable=function(e,n){!function(e,t){if(!x[e]||!v[e])return;for(var n in v[e]=!1,t)Object.prototype.hasOwnProperty.call(t,n)&&(b[n]=t[n]);0==--y&&0===g&&E()}(e,n),t&&t(e,n)};var n,r=!0,o="e40504ed846f17bf9a1d",l=1e4,i={},s=[],a=[];function d(e){var t=O[e];if(!t)return S;var r=function(r){return t.hot.active?(O[r]?-1===O[r].parents.indexOf(e)&&O[r].parents.push(e):(s=[e],n=r),-1===t.children.indexOf(r)&&t.children.push(r)):(console.warn("[HMR] unexpected require("+r+") from disposed module "+e),s=[]),S(r)},o=function(e){return{configurable:!0,enumerable:!0,get:function(){return S[e]},set:function(t){S[e]=t}}};for(var l in S)Object.prototype.hasOwnProperty.call(S,l)&&"e"!==l&&"t"!==l&&Object.defineProperty(r,l,o(l));return r.e=function(e){return"ready"===h&&p("prepare"),g++,S.e(e).then(t,function(e){throw t(),e});function t(){g--,"prepare"===h&&(w[e]||N(e),0===g&&0===y&&E())}},r.t=function(e,t){return 1&t&&(e=r(e)),S.t(e,-2&t)},r}function c(e){var t={_acceptedDependencies:{},_declinedDependencies:{},_selfAccepted:!1,_selfDeclined:!1,_disposeHandlers:[],_main:n!==e,active:!0,accept:function(e,n){if(void 0===e)t._selfAccepted=!0;else if("function"==typeof e)t._selfAccepted=e;else if("object"==typeof e)for(var r=0;r<e.length;r++)t._acceptedDependencies[e[r]]=n||function(){};else t._acceptedDependencies[e]=n||function(){}},decline:function(e){if(void 0===e)t._selfDeclined=!0;else if("object"==typeof e)for(var n=0;n<e.length;n++)t._declinedDependencies[e[n]]=!0;else t._declinedDependencies[e]=!0},dispose:function(e){t._disposeHandlers.push(e)},addDisposeHandler:function(e){t._disposeHandlers.push(e)},removeDisposeHandler:function(e){var n=t._disposeHandlers.indexOf(e);n>=0&&t._disposeHandlers.splice(n,1)},check:T,apply:q,status:function(e){if(!e)return h;u.push(e)},addStatusHandler:function(e){u.push(e)},removeStatusHandler:function(e){var t=u.indexOf(e);t>=0&&u.splice(t,1)},data:i[e]};return n=void 0,t}var u=[],h="idle";function p(e){h=e;for(var t=0;t<u.length;t++)u[t].call(null,e)}var f,b,m,y=0,g=0,w={},v={},x={};function C(e){return+e+""===e?+e:e}function T(e){if("idle"!==h)throw new Error("check() is only allowed in idle status");return r=e,p("check"),(t=l,t=t||1e4,new Promise(function(e,n){if("undefined"==typeof XMLHttpRequest)return n(new Error("No browser support"));try{var r=new XMLHttpRequest,l=S.p+""+o+".hot-update.json";r.open("GET",l,!0),r.timeout=t,r.send(null)}catch(e){return n(e)}r.onreadystatechange=function(){if(4===r.readyState)if(0===r.status)n(new Error("Manifest request to "+l+" timed out."));else if(404===r.status)e();else if(200!==r.status&&304!==r.status)n(new Error("Manifest request to "+l+" failed."));else{try{var t=JSON.parse(r.responseText)}catch(e){return void n(e)}e(t)}}})).then(function(e){if(!e)return p("idle"),null;v={},w={},x=e.c,m=e.h,p("prepare");var t=new Promise(function(e,t){f={resolve:e,reject:t}});b={};return N(0),"prepare"===h&&0===g&&0===y&&E(),t});var t}function N(e){x[e]?(v[e]=!0,y++,function(e){var t=document.createElement("script");t.charset="utf-8",t.src=S.p+""+e+"."+o+".hot-update.js",document.head.appendChild(t)}(e)):w[e]=!0}function E(){p("ready");var e=f;if(f=null,e)if(r)Promise.resolve().then(function(){return q(r)}).then(function(t){e.resolve(t)},function(t){e.reject(t)});else{var t=[];for(var n in b)Object.prototype.hasOwnProperty.call(b,n)&&t.push(C(n));e.resolve(t)}}function q(t){if("ready"!==h)throw new Error("apply() is only allowed in ready status");var n,r,l,a,d;function c(e){for(var t=[e],n={},r=t.slice().map(function(e){return{chain:[e],id:e}});r.length>0;){var o=r.pop(),l=o.id,i=o.chain;if((a=O[l])&&!a.hot._selfAccepted){if(a.hot._selfDeclined)return{type:"self-declined",chain:i,moduleId:l};if(a.hot._main)return{type:"unaccepted",chain:i,moduleId:l};for(var s=0;s<a.parents.length;s++){var d=a.parents[s],c=O[d];if(c){if(c.hot._declinedDependencies[l])return{type:"declined",chain:i.concat([d]),moduleId:l,parentId:d};-1===t.indexOf(d)&&(c.hot._acceptedDependencies[l]?(n[d]||(n[d]=[]),u(n[d],[l])):(delete n[d],t.push(d),r.push({chain:i.concat([d]),id:d})))}}}}return{type:"accepted",moduleId:e,outdatedModules:t,outdatedDependencies:n}}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];-1===e.indexOf(r)&&e.push(r)}}t=t||{};var f={},y=[],g={},w=function(){console.warn("[HMR] unexpected require("+T.moduleId+") to disposed module")};for(var v in b)if(Object.prototype.hasOwnProperty.call(b,v)){var T;d=C(v);var N=!1,E=!1,q=!1,_="";switch((T=b[v]?c(d):{type:"disposed",moduleId:v}).chain&&(_="\nUpdate propagation: "+T.chain.join(" -> ")),T.type){case"self-declined":t.onDeclined&&t.onDeclined(T),t.ignoreDeclined||(N=new Error("Aborted because of self decline: "+T.moduleId+_));break;case"declined":t.onDeclined&&t.onDeclined(T),t.ignoreDeclined||(N=new Error("Aborted because of declined dependency: "+T.moduleId+" in "+T.parentId+_));break;case"unaccepted":t.onUnaccepted&&t.onUnaccepted(T),t.ignoreUnaccepted||(N=new Error("Aborted because "+d+" is not accepted"+_));break;case"accepted":t.onAccepted&&t.onAccepted(T),E=!0;break;case"disposed":t.onDisposed&&t.onDisposed(T),q=!0;break;default:throw new Error("Unexception type "+T.type)}if(N)return p("abort"),Promise.reject(N);if(E)for(d in g[d]=b[d],u(y,T.outdatedModules),T.outdatedDependencies)Object.prototype.hasOwnProperty.call(T.outdatedDependencies,d)&&(f[d]||(f[d]=[]),u(f[d],T.outdatedDependencies[d]));q&&(u(y,[T.moduleId]),g[d]=w)}var A,R=[];for(r=0;r<y.length;r++)d=y[r],O[d]&&O[d].hot._selfAccepted&&R.push({module:d,errorHandler:O[d].hot._selfAccepted});p("dispose"),Object.keys(x).forEach(function(e){!1===x[e]&&function(e){delete installedChunks[e]}(e)});for(var M,I,B=y.slice();B.length>0;)if(d=B.pop(),a=O[d]){var D={},j=a.hot._disposeHandlers;for(l=0;l<j.length;l++)(n=j[l])(D);for(i[d]=D,a.hot.active=!1,delete O[d],delete f[d],l=0;l<a.children.length;l++){var L=O[a.children[l]];L&&((A=L.parents.indexOf(d))>=0&&L.parents.splice(A,1))}}for(d in f)if(Object.prototype.hasOwnProperty.call(f,d)&&(a=O[d]))for(I=f[d],l=0;l<I.length;l++)M=I[l],(A=a.children.indexOf(M))>=0&&a.children.splice(A,1);for(d in p("apply"),o=m,g)Object.prototype.hasOwnProperty.call(g,d)&&(e[d]=g[d]);var k=null;for(d in f)if(Object.prototype.hasOwnProperty.call(f,d)&&(a=O[d])){I=f[d];var H=[];for(r=0;r<I.length;r++)if(M=I[r],n=a.hot._acceptedDependencies[M]){if(-1!==H.indexOf(n))continue;H.push(n)}for(r=0;r<H.length;r++){n=H[r];try{n(I)}catch(e){t.onErrored&&t.onErrored({type:"accept-errored",moduleId:d,dependencyId:I[r],error:e}),t.ignoreErrored||k||(k=e)}}}for(r=0;r<R.length;r++){var P=R[r];d=P.module,s=[d];try{S(d)}catch(e){if("function"==typeof P.errorHandler)try{P.errorHandler(e)}catch(n){t.onErrored&&t.onErrored({type:"self-accept-error-handler-errored",moduleId:d,error:n,originalError:e}),t.ignoreErrored||k||(k=n),k||(k=e)}else t.onErrored&&t.onErrored({type:"self-accept-errored",moduleId:d,error:e}),t.ignoreErrored||k||(k=e)}}return k?(p("fail"),Promise.reject(k)):(p("idle"),new Promise(function(e){e(y)}))}var O={};function S(t){if(O[t])return O[t].exports;var n=O[t]={i:t,l:!1,exports:{},hot:c(t),parents:(a=s,s=[],a),children:[]};return e[t].call(n.exports,n,n.exports,d(t)),n.l=!0,n.exports}return S.m=e,S.c=O,S.d=function(e,t,n){S.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},S.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},S.t=function(e,t){if(1&t&&(e=S(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(S.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)S.d(n,r,function(t){return e[t]}.bind(null,r));return n},S.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return S.d(t,"a",t),t},S.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},S.p="",S.h=function(){return o},d(10)(S.s=10)}([function(t,n){t.exports=e},,function(e,t,n){},,,,,,,,function(e,t,n){"use strict";var r,o=n(11),l=(r=o)&&r.__esModule?r:{default:r};n(2),Quill.register({"modules/better-table":l.default},!0),window.onload=(()=>{const e=new Quill("#editor-wrapper",{theme:"snow",modules:{table:!1,"better-table":{operationMenu:{items:{unmergeCells:{text:"Another unmerge cells name"}}}},keyboard:{bindings:l.default.keyboardBindings}}});document.body.querySelector("#insert-table").onclick=(()=>{e.getModule("better-table").insertTable(3,3)})})},function(e,t,n){var r;window,e.exports=(r=n(0),function(e){var t=window.webpackHotUpdatequillBetterTable;window.webpackHotUpdatequillBetterTable=function(e,n){!function(e,t){if(x[e]&&v[e]){for(var n in v[e]=!1,t)Object.prototype.hasOwnProperty.call(t,n)&&(b[n]=t[n]);0==--y&&0===g&&E()}}(e,n),t&&t(e,n)};var n,r=!0,o="0669b40ee22f22cb9299",l=1e4,i={},s=[],a=[];function d(e){var t=O[e];if(!t)return S;var r=function(r){return t.hot.active?(O[r]?-1===O[r].parents.indexOf(e)&&O[r].parents.push(e):(s=[e],n=r),-1===t.children.indexOf(r)&&t.children.push(r)):(console.warn("[HMR] unexpected require("+r+") from disposed module "+e),s=[]),S(r)},o=function(e){return{configurable:!0,enumerable:!0,get:function(){return S[e]},set:function(t){S[e]=t}}};for(var l in S)Object.prototype.hasOwnProperty.call(S,l)&&"e"!==l&&"t"!==l&&Object.defineProperty(r,l,o(l));return r.e=function(e){return"ready"===h&&p("prepare"),g++,S.e(e).then(t,function(e){throw t(),e});function t(){g--,"prepare"===h&&(w[e]||N(e),0===g&&0===y&&E())}},r.t=function(e,t){return 1&t&&(e=r(e)),S.t(e,-2&t)},r}function c(e){var t={_acceptedDependencies:{},_declinedDependencies:{},_selfAccepted:!1,_selfDeclined:!1,_disposeHandlers:[],_main:n!==e,active:!0,accept:function(e,n){if(void 0===e)t._selfAccepted=!0;else if("function"==typeof e)t._selfAccepted=e;else if("object"==typeof e)for(var r=0;r<e.length;r++)t._acceptedDependencies[e[r]]=n||function(){};else t._acceptedDependencies[e]=n||function(){}},decline:function(e){if(void 0===e)t._selfDeclined=!0;else if("object"==typeof e)for(var n=0;n<e.length;n++)t._declinedDependencies[e[n]]=!0;else t._declinedDependencies[e]=!0},dispose:function(e){t._disposeHandlers.push(e)},addDisposeHandler:function(e){t._disposeHandlers.push(e)},removeDisposeHandler:function(e){var n=t._disposeHandlers.indexOf(e);n>=0&&t._disposeHandlers.splice(n,1)},check:T,apply:q,status:function(e){if(!e)return h;u.push(e)},addStatusHandler:function(e){u.push(e)},removeStatusHandler:function(e){var t=u.indexOf(e);t>=0&&u.splice(t,1)},data:i[e]};return n=void 0,t}var u=[],h="idle";function p(e){h=e;for(var t=0;t<u.length;t++)u[t].call(null,e)}var f,b,m,y=0,g=0,w={},v={},x={};function C(e){return+e+""===e?+e:e}function T(e){if("idle"!==h)throw new Error("check() is only allowed in idle status");return r=e,p("check"),(t=l,t=t||1e4,new Promise(function(e,n){if("undefined"==typeof XMLHttpRequest)return n(new Error("No browser support"));try{var r=new XMLHttpRequest,l=S.p+""+o+".hot-update.json";r.open("GET",l,!0),r.timeout=t,r.send(null)}catch(e){return n(e)}r.onreadystatechange=function(){if(4===r.readyState)if(0===r.status)n(new Error("Manifest request to "+l+" timed out."));else if(404===r.status)e();else if(200!==r.status&&304!==r.status)n(new Error("Manifest request to "+l+" failed."));else{try{var t=JSON.parse(r.responseText)}catch(e){return void n(e)}e(t)}}})).then(function(e){if(!e)return p("idle"),null;v={},w={},x=e.c,m=e.h,p("prepare");var t=new Promise(function(e,t){f={resolve:e,reject:t}});return b={},N(2),"prepare"===h&&0===g&&0===y&&E(),t});var t}function N(e){x[e]?(v[e]=!0,y++,function(e){var t=document.createElement("script");t.charset="utf-8",t.src=S.p+""+e+"."+o+".hot-update.js",document.head.appendChild(t)}(e)):w[e]=!0}function E(){p("ready");var e=f;if(f=null,e)if(r)Promise.resolve().then(function(){return q(r)}).then(function(t){e.resolve(t)},function(t){e.reject(t)});else{var t=[];for(var n in b)Object.prototype.hasOwnProperty.call(b,n)&&t.push(C(n));e.resolve(t)}}function q(t){if("ready"!==h)throw new Error("apply() is only allowed in ready status");var n,r,l,a,d;function c(e){for(var t=[e],n={},r=t.slice().map(function(e){return{chain:[e],id:e}});r.length>0;){var o=r.pop(),l=o.id,i=o.chain;if((a=O[l])&&!a.hot._selfAccepted){if(a.hot._selfDeclined)return{type:"self-declined",chain:i,moduleId:l};if(a.hot._main)return{type:"unaccepted",chain:i,moduleId:l};for(var s=0;s<a.parents.length;s++){var d=a.parents[s],c=O[d];if(c){if(c.hot._declinedDependencies[l])return{type:"declined",chain:i.concat([d]),moduleId:l,parentId:d};-1===t.indexOf(d)&&(c.hot._acceptedDependencies[l]?(n[d]||(n[d]=[]),u(n[d],[l])):(delete n[d],t.push(d),r.push({chain:i.concat([d]),id:d})))}}}}return{type:"accepted",moduleId:e,outdatedModules:t,outdatedDependencies:n}}function u(e,t){for(var n=0;n<t.length;n++){var r=t[n];-1===e.indexOf(r)&&e.push(r)}}t=t||{};var f={},y=[],g={},w=function(){console.warn("[HMR] unexpected require("+T.moduleId+") to disposed module")};for(var v in b)if(Object.prototype.hasOwnProperty.call(b,v)){var T;d=C(v);var N=!1,E=!1,q=!1,_="";switch((T=b[v]?c(d):{type:"disposed",moduleId:v}).chain&&(_="\nUpdate propagation: "+T.chain.join(" -> ")),T.type){case"self-declined":t.onDeclined&&t.onDeclined(T),t.ignoreDeclined||(N=new Error("Aborted because of self decline: "+T.moduleId+_));break;case"declined":t.onDeclined&&t.onDeclined(T),t.ignoreDeclined||(N=new Error("Aborted because of declined dependency: "+T.moduleId+" in "+T.parentId+_));break;case"unaccepted":t.onUnaccepted&&t.onUnaccepted(T),t.ignoreUnaccepted||(N=new Error("Aborted because "+d+" is not accepted"+_));break;case"accepted":t.onAccepted&&t.onAccepted(T),E=!0;break;case"disposed":t.onDisposed&&t.onDisposed(T),q=!0;break;default:throw new Error("Unexception type "+T.type)}if(N)return p("abort"),Promise.reject(N);if(E)for(d in g[d]=b[d],u(y,T.outdatedModules),T.outdatedDependencies)Object.prototype.hasOwnProperty.call(T.outdatedDependencies,d)&&(f[d]||(f[d]=[]),u(f[d],T.outdatedDependencies[d]));q&&(u(y,[T.moduleId]),g[d]=w)}var A,R=[];for(r=0;r<y.length;r++)d=y[r],O[d]&&O[d].hot._selfAccepted&&R.push({module:d,errorHandler:O[d].hot._selfAccepted});p("dispose"),Object.keys(x).forEach(function(e){!1===x[e]&&function(e){delete installedChunks[e]}(e)});for(var M,I,B=y.slice();B.length>0;)if(d=B.pop(),a=O[d]){var D={},j=a.hot._disposeHandlers;for(l=0;l<j.length;l++)(n=j[l])(D);for(i[d]=D,a.hot.active=!1,delete O[d],delete f[d],l=0;l<a.children.length;l++){var L=O[a.children[l]];L&&(A=L.parents.indexOf(d))>=0&&L.parents.splice(A,1)}}for(d in f)if(Object.prototype.hasOwnProperty.call(f,d)&&(a=O[d]))for(I=f[d],l=0;l<I.length;l++)M=I[l],(A=a.children.indexOf(M))>=0&&a.children.splice(A,1);for(d in p("apply"),o=m,g)Object.prototype.hasOwnProperty.call(g,d)&&(e[d]=g[d]);var k=null;for(d in f)if(Object.prototype.hasOwnProperty.call(f,d)&&(a=O[d])){I=f[d];var H=[];for(r=0;r<I.length;r++)if(M=I[r],n=a.hot._acceptedDependencies[M]){if(-1!==H.indexOf(n))continue;H.push(n)}for(r=0;r<H.length;r++){n=H[r];try{n(I)}catch(e){t.onErrored&&t.onErrored({type:"accept-errored",moduleId:d,dependencyId:I[r],error:e}),t.ignoreErrored||k||(k=e)}}}for(r=0;r<R.length;r++){var P=R[r];d=P.module,s=[d];try{S(d)}catch(e){if("function"==typeof P.errorHandler)try{P.errorHandler(e)}catch(n){t.onErrored&&t.onErrored({type:"self-accept-error-handler-errored",moduleId:d,error:n,originalError:e}),t.ignoreErrored||k||(k=n),k||(k=e)}else t.onErrored&&t.onErrored({type:"self-accept-errored",moduleId:d,error:e}),t.ignoreErrored||k||(k=e)}}return k?(p("fail"),Promise.reject(k)):(p("idle"),new Promise(function(e){e(y)}))}var O={};function S(t){if(O[t])return O[t].exports;var n=O[t]={i:t,l:!1,exports:{},hot:c(t),parents:(a=s,s=[],a),children:[]};return e[t].call(n.exports,n,n.exports,d(t)),n.l=!0,n.exports}return S.m=e,S.c=O,S.d=function(e,t,n){S.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},S.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},S.t=function(e,t){if(1&t&&(e=S(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(S.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)S.d(n,r,function(t){return e[t]}.bind(null,r));return n},S.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return S.d(t,"a",t),t},S.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},S.p="",S.h=function(){return o},d(8)(S.s=8)}([function(e,t){e.exports=r},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.css=function(e,t){if("object"==typeof t)for(let n in t)e.style[n]=t[n]}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.cellId=t.rowId=t.TableViewWrapper=t.TableContainer=t.TableBody=t.TableRow=t.TableCell=t.TableCellLine=t.TableColGroup=t.TableCol=void 0;var r,o=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,o=!1,l=void 0;try{for(var i,s=e[Symbol.iterator]();!(r=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){o=!0,l=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw l}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},l=n(0),i=(r=l)&&r.__esModule?r:{default:r};const s=i.default.import("blots/break"),a=i.default.import("blots/block"),d=i.default.import("blots/container"),c=["width"],u={width:100},h=["row","cell"],p=["rowspan","colspan"],f={rowspan:1,colspan:1},b=5;class m extends a{static create(e){const t=super.create(e);return h.forEach(n=>{let r=`${n}Id`;t.setAttribute(`data-${n}`,e[n]||r())}),p.forEach(n=>{t.setAttribute(`data-${n}`,e[n]||f[n])}),t}static formats(e){return p.concat(h).reduce((t,n)=>(e.hasAttribute(`data-${n}`)&&(t[n]=e.getAttribute(`data-${n}`)||void 0),t),{})}format(e,t){p.concat(h).indexOf(e)>-1?t?this.domNode.setAttribute(`data-${e}`,t):this.domNode.removeAttribute(`data-${e}`):super.format(e,t)}optimize(e){const t=this.domNode.getAttribute("data-row"),n=this.domNode.getAttribute("data-rowspan"),r=parseInt(this.domNode.getAttribute("data-colspan"),10);!this.statics.requiredContainer||this.parent instanceof this.statics.requiredContainer||this.wrap(this.statics.requiredContainer.blotName,{row:t,colspan:r,rowspan:n}),super.optimize(e)}tableCell(){return this.parent}}m.blotName="table-cell-line",m.ClassName="qlbt-cell-line",m.tagName="DIV";class y extends d{checkMerge(){if(super.checkMerge()&&null!=this.next.children.head){const e=this.children.head.formats()["table-cell-line"],t=this.children.tail.formats()["table-cell-line"],n=this.next.children.head.formats()["table-cell-line"],r=this.next.children.tail.formats()["table-cell-line"];return e.cell===t.cell&&e.cell===n.cell&&e.cell===r.cell}return!1}static create(e){const t=super.create(e);return t.setAttribute("data-row",e.row),p.forEach(n=>{e[n]&&t.setAttribute(n,e[n])}),t}static formats(e){const t={};return e.hasAttribute("data-row")&&(t.row=e.getAttribute("data-row")),p.reduce((t,n)=>(e.hasAttribute(n)&&(t[n]=e.getAttribute(n)),t),t)}cellOffset(){return this.parent?this.parent.children.indexOf(this):-1}formats(){const e={};return this.domNode.hasAttribute("data-row")&&(e.row=this.domNode.getAttribute("data-row")),p.reduce((e,t)=>(this.domNode.hasAttribute(t)&&(e[t]=this.domNode.getAttribute(t)),e),e)}toggleAttribute(e,t){t?this.domNode.setAttribute(e,t):this.domNode.removeAttribute(e)}formatChildren(e,t){this.children.forEach(n=>{n.format(e,t)})}format(e,t){p.indexOf(e)>-1?(this.toggleAttribute(e,t),this.formatChildren(e,t)):["row"].indexOf(e)>-1?(this.toggleAttribute(`data-${e}`,t),this.formatChildren(e,t)):super.format(e,t)}optimize(e){const t=this.domNode.getAttribute("data-row");!this.statics.requiredContainer||this.parent instanceof this.statics.requiredContainer||this.wrap(this.statics.requiredContainer.blotName,{row:t}),super.optimize(e)}row(){return this.parent}rowOffset(){return this.row()?this.row().rowOffset():-1}table(){return this.row()&&this.row().table()}}y.blotName="table",y.tagName="TD";class g extends d{checkMerge(){if(super.checkMerge()&&null!=this.next.children.head){const e=this.children.head.formats(),t=this.children.tail.formats(),n=this.next.children.head.formats(),r=this.next.children.tail.formats();return e.row===t.row&&e.row===n.row&&e.row===r.row}return!1}static create(e){const t=super.create(e);return t.setAttribute("data-row",e.row),t}formats(){return["row"].reduce((e,t)=>(this.domNode.hasAttribute(`data-${t}`)&&(e[t]=this.domNode.getAttribute(`data-${t}`)),e),{})}rowOffset(){return this.parent?this.parent.children.indexOf(this):-1}table(){return this.parent&&this.parent.parent}}g.blotName="table-row",g.tagName="TR";class w extends d{}w.blotName="table-body",w.tagName="TBODY";class v extends a{static create(e){let t=super.create(e);return c.forEach(n=>{t.setAttribute(`${n}`,e[n]||u[n])}),t}static formats(e){return c.reduce((t,n)=>(e.hasAttribute(`${n}`)&&(t[n]=e.getAttribute(`${n}`)||void 0),t),{})}format(e,t){c.indexOf(e)>-1?this.domNode.setAttribute(`${e}`,t||u[e]):super.format(e,t)}html(){return this.domNode.outerHTML}}v.blotName="table-col",v.tagName="col";class x extends d{}x.blotName="table-col-group",x.tagName="colgroup";class C extends d{static create(){return super.create()}constructor(e,t){super(e,t),this.updateTableWidth()}updateTableWidth(){setTimeout(()=>{const e=this.colGroup();if(!e)return;const t=e.children.reduce((e,t)=>e+=parseInt(t.formats()[v.blotName].width,10),0);this.domNode.style.width=`${t}px`},0)}getSelectedTds(){return this.selectedTds}cells(e){return this.rows().map(t=>t.children.at(e))}colGroup(){return this.children.head}deleteColumns(e,t=[]){var n=this.descendants(w);const r=o(n,1)[0];if(null==r||null==r.children.head)return;const l=this.descendants(y),i=[],s=[];if(l.forEach(t=>{const n=t.domNode.getBoundingClientRect(),r=e.x,o=e.x+e.width,l=n.x,a=n.x+n.width;l+b>r&&a-b<o?i.push(t):l<r+b&&a>o-b&&s.push(t)}),i.length===l.length)return this.tableDestroy(),!0;t.forEach(e=>{this.colGroup().children.at(t[0]).remove()}),i.forEach(e=>{e.remove()}),s.forEach(e=>{const n=parseInt(e.formats().colspan,10);parseInt(e.formats().width,10),e.format("colspan",n-t.length)}),this.updateTableWidth()}deleteRow(e){var t=this.descendants(w);const n=o(t,1)[0];if(null==n||null==n.children.head)return;const r=this.descendants(y),l=[],i=[],s=[];if(r.forEach(t=>{const n=t.domNode.getBoundingClientRect(),r=e.y,o=e.y+e.height,a=n.y,d=n.y+n.height;a>r-b&&d<o+b?l.push(t):a<r+b&&d>o-b&&(i.push(t),Math.abs(a-r)<b&&s.push(t))}),l.length===r.length)return void this.tableDestroy();const a=this.rows().reduce((t,n)=>{let r=n.domNode.getBoundingClientRect();return r.y>e.y-b&&r.y+r.height<e.y+e.height+b&&(t+=1),t},0);s.forEach(e=>{const t=e.domNode.getBoundingClientRect(),n=t.x+t.width,r=e.parent.next,o=r.children.reduce((e,t)=>{const r=t.domNode.getBoundingClientRect();return Math.abs(n-r.x)<b&&(e=t),e},null);r.insertBefore(e,o),e.format("row",r.formats().row)}),l.forEach(e=>{e.remove()}),i.forEach(e=>{const t=parseInt(e.formats().rowspan,10);e.format("rowspan",t-a)})}tableDestroy(){const e=i.default.find(this.scroll.domNode.parentNode),t=e.getModule("better-table");this.remove(),t.hideTableTools(),e.update(i.default.sources.USER)}insertCell(e,t){const n=E(),r=e.formats().row,o=this.scroll.create(y.blotName,Object.assign({},f,{row:r})),l=this.scroll.create(m.blotName,{row:r,cell:n});o.appendChild(l),t?e.insertBefore(o,t):e.appendChild(o)}insertColumn(e,t,n=!0){var r=this.descendants(w);const l=o(r,1)[0];var i=this.descendants(x);const s=o(i,1)[0],a=this.descendants(v);let d=[],c=[],u=[];if(null==l||null==l.children.head)return;this.descendants(y).forEach(t=>{const r=t.domNode.getBoundingClientRect(),o=r.x,l=r.x+r.width,i=e.x,s=e.x+e.width;n?Math.abs(l-s)<b?d.push(t):s-o>b&&s-l<-b&&c.push(t):Math.abs(o-i)<b?d.push(t):i-o>b&&i-l<-b&&c.push(t)}),d.forEach(e=>{const t=n?e.next:e,r=E(),o=e.parent,l=o.formats().row,i=e.formats(),s=this.scroll.create(y.blotName,Object.assign({},f,{row:l,rowspan:i.rowspan})),a=this.scroll.create(m.blotName,{row:l,cell:r,rowspan:i.rowspan});s.appendChild(a),t?o.insertBefore(s,t):o.appendChild(s),u.push(s)});const h=this.scroll.create(v.blotName,!0);let p=n?a[t].next:a[t];return p?s.insertBefore(h,p):s.appendChild(h),c.forEach(e=>{const t=e.formats().colspan;e.format("colspan",parseInt(t,10)+1),u.push(e)}),u.sort((e,t)=>e.domNode.getBoundingClientRect().y-t.domNode.getBoundingClientRect().y),this.updateTableWidth(),u}insertRow(e,t){var n=this.descendants(w);const r=o(n,1)[0];if(null==r||null==r.children.head)return;const l=this.descendants(y),i=N(),a=this.scroll.create(g.blotName,{row:i});let d=[],c=[],u=[];l.forEach(n=>{const r=n.domNode.getBoundingClientRect(),o=e.y,l=e.y+e.height,i=r.y,s=r.y+r.height;t?Math.abs(s-l)<b?d.push(n):l-i>b&&l-s<-b&&c.push(n):Math.abs(i-o)<b?d.push(n):o-i>b&&o-s<-b&&c.push(n)});const h=(e,t)=>e.domNode.getBoundingClientRect().x-t.domNode.getBoundingClientRect().x;d.sort(h),d.forEach(e=>{const t=E(),n=e.formats(),r=this.scroll.create(y.blotName,Object.assign({},f,{row:i,colspan:n.colspan})),o=this.scroll.create(m.blotName,{row:i,cell:t,colspan:n.colspan}),l=this.scroll.create(s.blotName);o.appendChild(l),r.appendChild(o),a.appendChild(r),u.push(r)}),c.forEach(e=>{const t=parseInt(e.formats().rowspan,10);e.format("rowspan",t+1),u.push(e)});const p=this.rows().find(n=>{let r=n.domNode.getBoundingClientRect();return t?Math.abs(r.y-e.y-e.height)<b:Math.abs(r.y-e.y)<b});return r.insertBefore(a,p),u.sort(h),u}mergeCells(e,t,n,r){const o=t.reduce((e,t,o)=>(0!==o?(e&&t.moveChildren(e),t.remove()):(t.format("colspan",r),t.format("rowspan",n),e=t),e),null);let l=o.domNode.getAttribute("data-row"),i=o.children.head.domNode.getAttribute("data-cell");return o.children.forEach(e=>{e.format("cell",i),e.format("row",l),e.format("colspan",r),e.format("rowspan",n)}),o}unmergeCells(e){let t={},n=1,r=1;e.forEach(e=>{if(t=e.formats(),n=t.rowspan,(r=t.colspan)>1){let t=e.next,n=e.row();e.format("colspan",1);for(let e=r;e>1;e--)this.insertCell(n,t)}if(n>1){let t=n,o=e.row().next;for(;t>1;){let n=o.children.reduce((t,n)=>{let r=e.domNode.getBoundingClientRect(),o=n.domNode.getBoundingClientRect();return Math.abs(r.x+r.width-o.x)<b&&(t=n),t},null);for(let e=r;e>0;e--)this.insertCell(o,n);t-=1,o=o.next}e.format("rowspan",1)}})}rows(){const e=this.children.tail;return null==e?[]:e.children.map(e=>e)}}C.blotName="table-container",C.className="quill-better-table",C.tagName="TABLE";class T extends d{constructor(e,t){super(e,t);const n=i.default.find(e.domNode.parentNode);t.addEventListener("scroll",e=>{const t=n.getModule("better-table");t.columnTool&&(t.columnTool.domNode.scrollLeft=e.target.scrollLeft)},!1)}}function N(){return`row-${Math.random().toString(36).slice(2,6)}`}function E(){return`cell-${Math.random().toString(36).slice(2,6)}`}T.blotName="table-view",T.className="quill-better-table-wrapper",T.tagName="DIV",T.allowedChildren=[C],C.requiredContainer=T,C.allowedChildren=[w,x],w.requiredContainer=C,w.allowedChildren=[g],g.requiredContainer=w,g.allowedChildren=[y],y.requiredContainer=g,y.allowedChildren=[m],m.requiredContainer=y,x.allowedChildren=[v],x.requiredContainer=C,v.requiredContainer=x,t.TableCol=v,t.TableColGroup=x,t.TableCellLine=m,t.TableCell=y,t.TableRow=g,t.TableBody=w,t.TableContainer=C,t.TableViewWrapper=T,t.rowId=N,t.cellId=E},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,o=!1,l=void 0;try{for(var i,s=e[Symbol.iterator]();!(r=(i=s.next()).done)&&(n.push(i.value),!t||n.length!==t);r=!0);}catch(e){o=!0,l=e}finally{try{!r&&s.return&&s.return()}finally{if(o)throw l}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")},o=d(n(0)),l=d(n(4)),i=d(n(5)),s=d(n(6)),a=n(2);function d(e){return e&&e.__esModule?e:{default:e}}const c=o.default.import("core/module"),u=o.default.import("delta");class h extends c{static register(){o.default.register(a.TableCol,!0),o.default.register(a.TableColGroup,!0),o.default.register(a.TableCellLine,!0),o.default.register(a.TableCell,!0),o.default.register(a.TableRow,!0),o.default.register(a.TableBody,!0),o.default.register(a.TableContainer,!0),o.default.register(a.TableViewWrapper,!0)}constructor(e,t){super(e,t),this.quill.root.addEventListener("click",n=>{if(!n.path||n.path.length<=0)return;const r=n.path.filter(e=>e.tagName&&"TABLE"===e.tagName.toUpperCase()&&e.classList.contains("quill-better-table"))[0];if(r){if(this.table===r)return;this.table&&this.hideTableTools(),this.showTableTools(r,e,t)}else this.table&&this.hideTableTools()},!1),this.quill.root.addEventListener("contextmenu",n=>{if(!this.table)return!0;if(n.preventDefault(),!n.path||n.path.length<=0)return;const r=n.path.filter(e=>e.tagName&&"TABLE"===e.tagName.toUpperCase()&&e.classList.contains("quill-better-table"))[0],o=n.path.filter(e=>e.tagName&&"TR"===e.tagName.toUpperCase()&&e.getAttribute("data-row"))[0],l=n.path.filter(e=>e.tagName&&"TD"===e.tagName.toUpperCase()&&e.getAttribute("data-row"))[0];let i=this.tableSelection.selectedTds.map(e=>e.domNode).includes(l);(this.tableSelection.selectedTds.length<=0||!i)&&this.tableSelection.setSelection(l.getBoundingClientRect(),l.getBoundingClientRect()),this.tableOperationMenu&&(this.tableOperationMenu=this.tableOperationMenu.destroy()),r&&(this.tableOperationMenu=new s.default({table:r,row:o,cell:l,left:n.pageX,top:n.pageY},e,t.operationMenu))},!1),e.getModule("keyboard"),e.keyboard.addBinding({key:"Backspace"},{},function(e,t){if(0===e.index||this.quill.getLength()<=1)return!0;var n=this.quill.getLine(e.index);const o=r(n,1)[0];if(0===t.offset){var l=this.quill.getLine(e.index-1);const t=r(l,1)[0];if(null!=t&&"table-cell-line"===t.statics.blotName&&"table-cell-line"!==o.statics.blotName)return!1}return!0});let n=e.keyboard.bindings.Backspace.pop();e.keyboard.bindings.Backspace.splice(0,1,n)}getTable(e=this.quill.getSelection()){if(null==e)return[null,null,null,-1];var t=this.quill.getLine(e.index),n=r(t,2);const o=n[0],l=n[1];if(null==o||o.statics.blotName!==a.TableCellLine.blotName)return[null,null,null,-1];const i=o.tableCell(),s=i.row();return[s.table(),s,i,l]}insertTable(e,t){const n=this.quill.getSelection(!0);if(null==n)return;this.quill.getLeaf(n.index)[0],this.quill.getLeaf(n.index+1)[0];let r=(new u).retain(n.index);r.insert("\n"),r=new Array(t).fill("\n").reduce((e,t)=>(e.insert(t,{"table-col":!0}),e),r),r=new Array(e).fill(0).reduce(e=>{let n=(0,a.rowId)();return new Array(t).fill("\n").reduce((e,t)=>(e.insert(t,{"table-cell-line":{row:n,cell:(0,a.cellId)()}}),e),e)},r),this.quill.updateContents(r,o.default.sources.USER),this.quill.setSelection(n.index+1,o.default.sources.SILENT)}showTableTools(e,t,n){this.table=e,this.columnTool=new l.default(e,t,n),this.tableSelection=new i.default(e,t,n)}hideTableTools(){this.columnTool.destroy(),this.tableSelection.destroy(),this.tableOperationMenu&&this.tableOperationMenu.destroy(),this.columnTool=null,this.tableSelection=null,this.tableOperationMenu=null,this.table=null}}h.keyboardBindings={"table-cell-line backspace":{key:"Backspace",format:["table-cell-line"],collapsed:!0,offset:0,handler(e,t){var n=this.quill.getLine(e.index),o=r(n,2);const l=o[0];return o[1],!(!l.prev||"table-cell-line"!==l.prev.statics.blotName)}},"table-cell-line delete":{key:"Delete",format:["table-cell-line"],collapsed:!0,suffix:/^$/,handler(){}},"table-cell-line enter":{key:"Enter",shiftKey:null,format:["table-cell-line"],handler(e,t){if(this.quill.selection&&this.quill.selection.composing)return;const n=o.default.imports.parchment.Scope;e.length>0&&this.quill.scroll.deleteAt(e.index,e.length);const r=Object.keys(t.format).reduce((e,r)=>(this.quill.scroll.query(r,n.BLOCK)&&!Array.isArray(t.format[r])&&(e[r]=t.format[r]),e),{});this.quill.insertText(e.index,"\n",r["table-cell-line"],o.default.sources.USER),this.quill.setSelection(e.index+1,o.default.sources.SILENT),this.quill.focus(),Object.keys(t.format).forEach(e=>{null==r[e]&&(Array.isArray(t.format[e])||"link"!==e&&this.quill.format(e,t.format[e],o.default.sources.USER))})}}},t.default=h},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=n(0),l=(r=o)&&r.__esModule?r:{default:r},i=n(1);t.default=class{constructor(e,t,n){if(!e)return null;this.table=e,this.quill=t,this.options=n,this.domNode=null,this.initColTool()}initColTool(){const e=this.quill.root.parentNode,t=(this.table.getBoundingClientRect(),e.getBoundingClientRect()),n=this.table.parentNode.getBoundingClientRect();this.domNode=document.createElement("div"),this.domNode.classList.add("qlbt-col-tool"),this.updateToolCells(),e.appendChild(this.domNode),(0,i.css)(this.domNode,{width:`${n.width}px`,height:"12px",left:`${n.left-t.left+e.scrollLeft}px`,top:`${n.top-t.top+e.scrollTop-12-5}px`})}createToolCell(){const e=document.createElement("div");e.classList.add("qlbt-col-tool-cell");const t=document.createElement("div");return t.classList.add("qlbt-col-tool-cell-holder"),(0,i.css)(e,{height:"12px"}),e.appendChild(t),e}updateToolCells(){const e=l.default.find(this.table),t=e.children.tail.children.head.children,n=e.colGroup().children,r=function(e){return e.reduce((e,t)=>{const n=t.formats().colspan;return e+=parseInt(n,10)},0)}(t);let o=Array.from(this.domNode.querySelectorAll(".qlbt-col-tool-cell"));for(let e=0;e<Math.max(r,o.length);e++){let t=n.at(e),l=t&&parseInt(t.formats()[t.statics.blotName].width,10),s=null;o[e]?o[e]&&e>=r?o[e].remove():(s=o[e],(0,i.css)(s,{"min-width":`${l}px`})):(s=this.createToolCell(),this.domNode.appendChild(s),this.addColCellHolderHandler(s),(0,i.css)(s,{"min-width":`${l}px`}))}}destroy(){return this.domNode.remove(),null}addColCellHolderHandler(e){const t=l.default.find(this.table),n=e.querySelector(".qlbt-col-tool-cell-holder");let r=!1,o=0,s=0,a=0,d=0,c={},u={},h=null;const p=e=>{e.preventDefault(),r&&(s=e.clientX,a=d+s-o>=50?s-o:50-d,(0,i.css)(h,{left:`${u.left+u.width-1+a}px`}))},f=l=>{l.preventDefault();const b=Array.from(this.domNode.querySelectorAll(".qlbt-col-tool-cell")).indexOf(e),m=t.colGroup().children.at(b);r&&(m.format("width",d+a),(0,i.css)(e,{"min-width":`${d+a}px`}),o=0,s=0,a=0,d=0,r=!1,n.classList.remove("dragging")),document.removeEventListener("mousemove",p,!1),document.removeEventListener("mouseup",f,!1),c={},u={},h.remove(),h=null,t.updateTableWidth();const y=this.quill.getModule("better-table").tableSelection;y&&y.clearSelection()};n.addEventListener("mousedown",t=>{document.addEventListener("mousemove",p,!1),document.addEventListener("mouseup",f,!1),c=this.table.getBoundingClientRect(),u=e.getBoundingClientRect(),h=document.createElement("div"),(0,i.css)(h,{position:"fixed",top:`${u.top}px`,left:`${u.left+u.width-1}px`,zIndex:"100",height:`${c.height+12+4}px`,width:"1px",backgroundColor:"#35A7ED"}),document.body.appendChild(h),r=!0,o=t.clientX,d=u.width,n.classList.add("dragging")},!1)}colToolCells(){return Array.from(this.domNode.querySelectorAll(".qlbt-col-tool-cell"))}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=n(0),l=(r=o)&&r.__esModule?r:{default:r},i=n(1),s=n(2);const a=["left","right","top","bottom"];function d(e,t){let n=Math.min(e.x,t.x,e.x+e.width-1,t.x+t.width-1),r=Math.max(e.x,t.x,e.x+e.width-1,t.x+t.width-1),o=Math.min(e.y,t.y,e.y+e.height-1,t.y+t.height-1),l=Math.max(e.y,t.y,e.y+e.height-1,t.y+t.height-1);return{x:n,x1:r,y:o,y1:l,width:r-n,height:l-o}}t.default=class{constructor(e,t,n){if(!e)return null;this.table=e,this.quill=t,this.options=n,this.boundary={},this.selectedTds=[],this.dragging=!1,this.selectingHandler=this.mouseDownHandler.bind(this),this.clearSelectionHanler=this.clearSelection.bind(this),this.helpLinesInitial(),this.quill.root.addEventListener("mousedown",this.selectingHandler,!1),this.quill.on("text-change",this.clearSelectionHanler)}helpLinesInitial(){let e=this.quill.root.parentNode;a.forEach(t=>{this[t]=document.createElement("div"),this[t].classList.add("qlbt-selection-line"),(0,i.css)(this[t],{position:"absolute",display:"none","background-color":"#35A7ED"}),e.appendChild(this[t])})}mouseDownHandler(e){if(0!==e.button||!e.target.closest(".quill-better-table"))return;this.quill.root.addEventListener("mousemove",o,!1),this.quill.root.addEventListener("mouseup",function e(n){t.quill.root.removeEventListener("mousemove",o,!1),t.quill.root.removeEventListener("mouseup",e,!1),t.dragging=!1},!1);const t=this,n=e.target.closest("td[data-row]"),r=n.getBoundingClientRect();function o(e){if(0!==e.button||!e.target.closest(".quill-better-table"))return;const o=e.target.closest("td[data-row]"),l=o.getBoundingClientRect();t.boundary=d(r,l),t.correctBoundary(),t.selectedTds=t.computeSelectedTds(),t.repositionHelpLines(),n!==o&&t.quill.blur()}this.dragging=!0,this.boundary=d(r,r),this.correctBoundary(),this.selectedTds=this.computeSelectedTds(),this.repositionHelpLines()}correctBoundary(){l.default.find(this.table).descendants(s.TableCell).forEach(e=>{var t=e.domNode.getBoundingClientRect();let n=t.x,r=t.y,o=t.width,l=t.height;(n+2>=this.boundary.x&&n+2<=this.boundary.x1||n-2+o>=this.boundary.x&&n-2+o<=this.boundary.x1)&&(r+2>=this.boundary.y&&r+2<=this.boundary.y1||r-2+l>=this.boundary.y&&r-2+l<=this.boundary.y1)&&(this.boundary=d(this.boundary,{x:n,y:r,width:o,height:l}))})}computeSelectedTds(){return l.default.find(this.table).descendants(s.TableCell).reduce((e,t)=>{var n=t.domNode.getBoundingClientRect();let r=n.x,o=n.y,l=n.width,i=n.height;return r+2>=this.boundary.x&&r-2+l<=this.boundary.x1&&o+2>=this.boundary.y&&o-2+i<=this.boundary.y1&&e.push(t),e},[])}repositionHelpLines(){const e=this.quill.root.parentNode.getBoundingClientRect();(0,i.css)(this.left,{display:"block",left:`${this.boundary.x-e.x-1}px`,top:`${this.boundary.y-e.y}px`,height:`${this.boundary.y1-this.boundary.y+1}px`,width:"1px"}),(0,i.css)(this.right,{display:"block",left:`${this.boundary.x1-e.x}px`,top:`${this.boundary.y-e.y}px`,height:`${this.boundary.y1-this.boundary.y+1}px`,width:"1px"}),(0,i.css)(this.top,{display:"block",left:`${this.boundary.x-e.x-1}px`,top:`${this.boundary.y-e.y}px`,width:`${this.boundary.x1-this.boundary.x+1}px`,height:"1px"}),(0,i.css)(this.bottom,{display:"block",left:`${this.boundary.x-e.x-1}px`,top:`${this.boundary.y1-e.y+1}px`,width:`${this.boundary.x1-this.boundary.x+1}px`,height:"1px"})}refreshHelpLinesPosition(){this.selectedTds[0].domNode.getBoundingClientRect();const e=this.selectedTds[this.selectedTds.length-1].domNode.getBoundingClientRect();this.boundary=d(startTdRect,e),this.repositionHelpLines()}destroy(){return a.forEach(e=>{this[e].remove(),this[e]=null}),this.quill.root.removeEventListener("mousedown",this.selectingHandler,!1),this.quill.off("text-change",this.clearSelectionHanler),null}setSelection(e,t){this.boundary=d(e,t),this.correctBoundary(),this.selectedTds=this.computeSelectedTds(),this.repositionHelpLines()}clearSelection(){this.boundary={},this.selectedTds=[],a.forEach(e=>{this[e]&&(0,i.css)(this[e],{display:"none"})})}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=n(0),l=(r=o)&&r.__esModule?r:{default:r},i=n(1);const s={insertColumnRight:{text:"Insert column right",handler(){const e=l.default.find(this.table);let t=a(this.columnToolCells,this.boundary,(e,t)=>Math.abs(e.x+e.width-t.x1)<=3);const n=e.insertColumn(this.boundary,t,!0);this.tableColumnTool.updateToolCells(),this.quill.update(l.default.sources.USER),this.quill.setSelection(this.quill.getIndex(n[0]),0,l.default.sources.SILENT),this.tableSelection.setSelection(n[0].domNode.getBoundingClientRect(),n[0].domNode.getBoundingClientRect())}},insertColumnLeft:{text:"Insert column left",handler(){const e=l.default.find(this.table);let t=a(this.columnToolCells,this.boundary,(e,t)=>Math.abs(e.x-t.x)<=3);const n=e.insertColumn(this.boundary,t,!1);this.tableColumnTool.updateToolCells(),this.quill.update(l.default.sources.USER),this.quill.setSelection(this.quill.getIndex(n[0]),0,l.default.sources.SILENT),this.tableSelection.setSelection(n[0].domNode.getBoundingClientRect(),n[0].domNode.getBoundingClientRect())}},insertRowUp:{text:"Insert row up",handler(){const e=l.default.find(this.table).insertRow(this.boundary,!1);this.quill.update(l.default.sources.USER),this.quill.setSelection(this.quill.getIndex(e[0]),0,l.default.sources.SILENT),this.tableSelection.setSelection(e[0].domNode.getBoundingClientRect(),e[0].domNode.getBoundingClientRect())}},insertRowDown:{text:"Insert row down",handler(){const e=l.default.find(this.table).insertRow(this.boundary,!0);this.quill.update(l.default.sources.USER),this.quill.setSelection(this.quill.getIndex(e[0]),0,l.default.sources.SILENT),this.tableSelection.setSelection(e[0].domNode.getBoundingClientRect(),e[0].domNode.getBoundingClientRect())}},mergeCells:{text:"Merge selected cells",handler(){const e=l.default.find(this.table),t=e.rows().reduce((e,t)=>{let n=t.domNode.getBoundingClientRect();return n.y>this.boundary.y-3&&n.y+n.height<this.boundary.y+this.boundary.height+3&&(e+=1),e},0),n=this.columnToolCells.reduce((e,t)=>{let n=t.getBoundingClientRect();return n.x>this.boundary.x-3&&n.x+n.width<this.boundary.x+this.boundary.width+3&&(e+=1),e},0),r=e.mergeCells(this.boundary,this.selectedTds,t,n);this.quill.update(l.default.sources.USER),this.tableSelection.setSelection(r.domNode.getBoundingClientRect(),r.domNode.getBoundingClientRect())}},unmergeCells:{text:"Unmerge cells",handler(){l.default.find(this.table).unmergeCells(this.selectedTds),this.quill.update(l.default.sources.USER),this.tableSelection.clearSelection()}},deleteColumn:{text:"Delete selected columns",handler(){const e=l.default.find(this.table);let t=(n=this.columnToolCells,r=this.boundary,o=((e,t)=>e.x+3>t.x&&e.x+e.width-3<t.x1),n.reduce((e,t)=>{let l=t.getBoundingClientRect();return o(l,r)&&e.push(n.indexOf(t)),e},[]));var n,r,o;e.deleteColumns(this.boundary,t)||(this.tableColumnTool.updateToolCells(),this.quill.update(l.default.sources.USER),this.tableSelection.clearSelection())}},deleteRow:{text:"Delete selected rows",handler(){l.default.find(this.table).deleteRow(this.boundary),this.quill.update(l.default.sources.USER),this.tableSelection.clearSelection()}},deleteTable:{text:"Delete table",handler(){const e=this.quill.getModule("better-table"),t=l.default.find(this.table);e.hideTableTools(),t.remove(),this.quill.update(l.default.sources.USER)}}};function a(e,t,n){return e.reduce((r,o)=>{let l=o.getBoundingClientRect();return n(l,t)&&(r=e.indexOf(o)),r},!1)}t.default=class{constructor(e,t,n){const r=t.getModule("better-table");this.tableSelection=r.tableSelection,this.table=e.table,this.quill=t,this.options=n,this.menuItems=Object.assign({},s,n.items),this.tableColumnTool=r.columnTool,this.boundary=this.tableSelection.boundary,this.selectedTds=this.tableSelection.selectedTds,this.destroyHanlder=this.destroy.bind(this),this.columnToolCells=this.tableColumnTool.colToolCells(),this.menuInitial(e),this.mount(),document.addEventListener("click",this.destroyHanlder,!1)}mount(){document.body.appendChild(this.domNode)}destroy(){return this.domNode.remove(),document.removeEventListener("click",this.destroyHanlder,!1),null}menuInitial({table:e,left:t,top:n}){this.domNode=document.createElement("div"),this.domNode.classList.add("qlbt-operation-menu"),(0,i.css)(this.domNode,{position:"absolute",left:`${t}px`,top:`${n}px`,"min-height":"150px",width:"200px"});for(let e in this.menuItems)this.menuItems[e]&&this.domNode.appendChild(this.menuItemCreator(Object.assign({},s[e],this.menuItems[e])))}menuItemCreator({text:e,handler:t}){const n=document.createElement("div");return n.classList.add("qlbt-operation-menu-item"),n.innerText=e,n.addEventListener("click",t.bind(this),!1),n}}},,function(e,t,n){e.exports=n(3)}]).default)}]).default});