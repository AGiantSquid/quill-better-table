!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("quill")):"function"==typeof define&&define.amd?define(["quill"],t):"object"==typeof exports?exports.quillBetterTable=t(require("quill")):e.quillBetterTable=t(e.Quill)}(window,function(e){return function(e){var t=window.webpackHotUpdatequillBetterTable;window.webpackHotUpdatequillBetterTable=function(e,r){!function(e,t){if(!v[e]||!x[e])return;for(var r in x[e]=!1,t)Object.prototype.hasOwnProperty.call(t,r)&&(b[r]=t[r]);0==--g&&0===y&&q()}(e,r),t&&t(e,r)};var r,o=!0,n="984675d52ac262591eab",l=1e4,i={},s=[],a=[];function d(e){var t=R[e];if(!t)return S;var o=function(o){return t.hot.active?(R[o]?-1===R[o].parents.indexOf(e)&&R[o].parents.push(e):(s=[e],r=o),-1===t.children.indexOf(o)&&t.children.push(o)):(console.warn("[HMR] unexpected require("+o+") from disposed module "+e),s=[]),S(o)},n=function(e){return{configurable:!0,enumerable:!0,get:function(){return S[e]},set:function(t){S[e]=t}}};for(var l in S)Object.prototype.hasOwnProperty.call(S,l)&&"e"!==l&&"t"!==l&&Object.defineProperty(o,l,n(l));return o.e=function(e){return"ready"===h&&p("prepare"),y++,S.e(e).then(t,function(e){throw t(),e});function t(){y--,"prepare"===h&&(w[e]||T(e),0===y&&0===g&&q())}},o.t=function(e,t){return 1&t&&(e=o(e)),S.t(e,-2&t)},o}function c(e){var t={_acceptedDependencies:{},_declinedDependencies:{},_selfAccepted:!1,_selfDeclined:!1,_disposeHandlers:[],_main:r!==e,active:!0,accept:function(e,r){if(void 0===e)t._selfAccepted=!0;else if("function"==typeof e)t._selfAccepted=e;else if("object"==typeof e)for(var o=0;o<e.length;o++)t._acceptedDependencies[e[o]]=r||function(){};else t._acceptedDependencies[e]=r||function(){}},decline:function(e){if(void 0===e)t._selfDeclined=!0;else if("object"==typeof e)for(var r=0;r<e.length;r++)t._declinedDependencies[e[r]]=!0;else t._declinedDependencies[e]=!0},dispose:function(e){t._disposeHandlers.push(e)},addDisposeHandler:function(e){t._disposeHandlers.push(e)},removeDisposeHandler:function(e){var r=t._disposeHandlers.indexOf(e);r>=0&&t._disposeHandlers.splice(r,1)},check:C,apply:E,status:function(e){if(!e)return h;u.push(e)},addStatusHandler:function(e){u.push(e)},removeStatusHandler:function(e){var t=u.indexOf(e);t>=0&&u.splice(t,1)},data:i[e]};return r=void 0,t}var u=[],h="idle";function p(e){h=e;for(var t=0;t<u.length;t++)u[t].call(null,e)}var f,b,m,g=0,y=0,w={},x={},v={};function N(e){return+e+""===e?+e:e}function C(e){if("idle"!==h)throw new Error("check() is only allowed in idle status");return o=e,p("check"),(t=l,t=t||1e4,new Promise(function(e,r){if("undefined"==typeof XMLHttpRequest)return r(new Error("No browser support"));try{var o=new XMLHttpRequest,l=S.p+""+n+".hot-update.json";o.open("GET",l,!0),o.timeout=t,o.send(null)}catch(e){return r(e)}o.onreadystatechange=function(){if(4===o.readyState)if(0===o.status)r(new Error("Manifest request to "+l+" timed out."));else if(404===o.status)e();else if(200!==o.status&&304!==o.status)r(new Error("Manifest request to "+l+" failed."));else{try{var t=JSON.parse(o.responseText)}catch(e){return void r(e)}e(t)}}})).then(function(e){if(!e)return p("idle"),null;x={},w={},v=e.c,m=e.h,p("prepare");var t=new Promise(function(e,t){f={resolve:e,reject:t}});b={};return T(0),"prepare"===h&&0===y&&0===g&&q(),t});var t}function T(e){v[e]?(x[e]=!0,g++,function(e){var t=document.createElement("script");t.charset="utf-8",t.src=S.p+""+e+"."+n+".hot-update.js",document.head.appendChild(t)}(e)):w[e]=!0}function q(){p("ready");var e=f;if(f=null,e)if(o)Promise.resolve().then(function(){return E(o)}).then(function(t){e.resolve(t)},function(t){e.reject(t)});else{var t=[];for(var r in b)Object.prototype.hasOwnProperty.call(b,r)&&t.push(N(r));e.resolve(t)}}function E(t){if("ready"!==h)throw new Error("apply() is only allowed in ready status");var r,o,l,a,d;function c(e){for(var t=[e],r={},o=t.slice().map(function(e){return{chain:[e],id:e}});o.length>0;){var n=o.pop(),l=n.id,i=n.chain;if((a=R[l])&&!a.hot._selfAccepted){if(a.hot._selfDeclined)return{type:"self-declined",chain:i,moduleId:l};if(a.hot._main)return{type:"unaccepted",chain:i,moduleId:l};for(var s=0;s<a.parents.length;s++){var d=a.parents[s],c=R[d];if(c){if(c.hot._declinedDependencies[l])return{type:"declined",chain:i.concat([d]),moduleId:l,parentId:d};-1===t.indexOf(d)&&(c.hot._acceptedDependencies[l]?(r[d]||(r[d]=[]),u(r[d],[l])):(delete r[d],t.push(d),o.push({chain:i.concat([d]),id:d})))}}}}return{type:"accepted",moduleId:e,outdatedModules:t,outdatedDependencies:r}}function u(e,t){for(var r=0;r<t.length;r++){var o=t[r];-1===e.indexOf(o)&&e.push(o)}}t=t||{};var f={},g=[],y={},w=function(){console.warn("[HMR] unexpected require("+C.moduleId+") to disposed module")};for(var x in b)if(Object.prototype.hasOwnProperty.call(b,x)){var C;d=N(x);var T=!1,q=!1,E=!1,A="";switch((C=b[x]?c(d):{type:"disposed",moduleId:x}).chain&&(A="\nUpdate propagation: "+C.chain.join(" -> ")),C.type){case"self-declined":t.onDeclined&&t.onDeclined(C),t.ignoreDeclined||(T=new Error("Aborted because of self decline: "+C.moduleId+A));break;case"declined":t.onDeclined&&t.onDeclined(C),t.ignoreDeclined||(T=new Error("Aborted because of declined dependency: "+C.moduleId+" in "+C.parentId+A));break;case"unaccepted":t.onUnaccepted&&t.onUnaccepted(C),t.ignoreUnaccepted||(T=new Error("Aborted because "+d+" is not accepted"+A));break;case"accepted":t.onAccepted&&t.onAccepted(C),q=!0;break;case"disposed":t.onDisposed&&t.onDisposed(C),E=!0;break;default:throw new Error("Unexception type "+C.type)}if(T)return p("abort"),Promise.reject(T);if(q)for(d in y[d]=b[d],u(g,C.outdatedModules),C.outdatedDependencies)Object.prototype.hasOwnProperty.call(C.outdatedDependencies,d)&&(f[d]||(f[d]=[]),u(f[d],C.outdatedDependencies[d]));E&&(u(g,[C.moduleId]),y[d]=w)}var O,L=[];for(o=0;o<g.length;o++)d=g[o],R[d]&&R[d].hot._selfAccepted&&L.push({module:d,errorHandler:R[d].hot._selfAccepted});p("dispose"),Object.keys(v).forEach(function(e){!1===v[e]&&function(e){delete installedChunks[e]}(e)});for(var _,B,M=g.slice();M.length>0;)if(d=M.pop(),a=R[d]){var I={},j=a.hot._disposeHandlers;for(l=0;l<j.length;l++)(r=j[l])(I);for(i[d]=I,a.hot.active=!1,delete R[d],delete f[d],l=0;l<a.children.length;l++){var k=R[a.children[l]];k&&((O=k.parents.indexOf(d))>=0&&k.parents.splice(O,1))}}for(d in f)if(Object.prototype.hasOwnProperty.call(f,d)&&(a=R[d]))for(B=f[d],l=0;l<B.length;l++)_=B[l],(O=a.children.indexOf(_))>=0&&a.children.splice(O,1);for(d in p("apply"),n=m,y)Object.prototype.hasOwnProperty.call(y,d)&&(e[d]=y[d]);var H=null;for(d in f)if(Object.prototype.hasOwnProperty.call(f,d)&&(a=R[d])){B=f[d];var D=[];for(o=0;o<B.length;o++)if(_=B[o],r=a.hot._acceptedDependencies[_]){if(-1!==D.indexOf(r))continue;D.push(r)}for(o=0;o<D.length;o++){r=D[o];try{r(B)}catch(e){t.onErrored&&t.onErrored({type:"accept-errored",moduleId:d,dependencyId:B[o],error:e}),t.ignoreErrored||H||(H=e)}}}for(o=0;o<L.length;o++){var $=L[o];d=$.module,s=[d];try{S(d)}catch(e){if("function"==typeof $.errorHandler)try{$.errorHandler(e)}catch(r){t.onErrored&&t.onErrored({type:"self-accept-error-handler-errored",moduleId:d,error:r,originalError:e}),t.ignoreErrored||H||(H=r),H||(H=e)}else t.onErrored&&t.onErrored({type:"self-accept-errored",moduleId:d,error:e}),t.ignoreErrored||H||(H=e)}}return H?(p("fail"),Promise.reject(H)):(p("idle"),new Promise(function(e){e(g)}))}var R={};function S(t){if(R[t])return R[t].exports;var r=R[t]={i:t,l:!1,exports:{},hot:c(t),parents:(a=s,s=[],a),children:[]};return e[t].call(r.exports,r,r.exports,d(t)),r.l=!0,r.exports}return S.m=e,S.c=R,S.d=function(e,t,r){S.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},S.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},S.t=function(e,t){if(1&t&&(e=S(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(S.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)S.d(r,o,function(t){return e[t]}.bind(null,o));return r},S.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return S.d(t,"a",t),t},S.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},S.p="",S.h=function(){return n},d(12)(S.s=12)}([function(t,r){t.exports=e},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.css=function(e,t){if("object"==typeof t)for(let r in t)e.style[r]=t[r]},t.getRelativeRect=function(e,t){let r=t.getBoundingClientRect();return{x:e.x-r.x-t.scrollLeft,y:e.y-r.y-t.scrollTop,x1:e.x-r.x-t.scrollLeft+e.width,y1:e.y-r.y-t.scrollTop+e.height,width:e.width,height:e.height}},t._omit=function(e,t){return e&&Object.keys(e).reduce((r,o)=>t.includes(o)?r:Object.assign({},r,{[o]:e[o]}),{})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CELL_ATTRIBUTES=t.CELL_IDENTITY_KEYS=t.cellId=t.rowId=t.TableViewWrapper=t.TableContainer=t.TableBody=t.TableRow=t.TableCell=t.TableCellLine=t.TableColGroup=t.TableCol=void 0;var o=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],o=!0,n=!1,l=void 0;try{for(var i,s=e[Symbol.iterator]();!(o=(i=s.next()).done)&&(r.push(i.value),!t||r.length!==t);o=!0);}catch(e){n=!0,l=e}finally{try{!o&&s.return&&s.return()}finally{if(n)throw l}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),n=s(r(0)),l=r(1),i=s(r(3));function s(e){return e&&e.__esModule?e:{default:e}}const a=n.default.import("blots/break"),d=n.default.import("blots/block"),c=n.default.import("blots/container"),u=["width"],h={width:100},p=["row","cell"],f=["rowspan","colspan"],b={rowspan:1,colspan:1},m=5;class g extends d{static create(e){const t=super.create(e);return p.forEach(r=>{let o="row"===r?q:E;t.setAttribute(`data-${r}`,e[r]||o())}),f.forEach(r=>{t.setAttribute(`data-${r}`,e[r]||b[r])}),t}static formats(e){return f.concat(p).reduce((t,r)=>(e.hasAttribute(`data-${r}`)&&(t[r]=e.getAttribute(`data-${r}`)||void 0),t),{})}format(e,t){if(f.concat(p).indexOf(e)>-1)t?this.domNode.setAttribute(`data-${e}`,t):this.domNode.removeAttribute(`data-${e}`);else if("header"===e){if(!t)return;var r=g.formats(this.domNode);const o=r.row,n=r.cell,l=r.rowspan,i=r.colspan;super.format(e,{value:t,row:o,cell:n,rowspan:l,colspan:i})}else super.format(e,t)}optimize(e){const t=this.domNode.getAttribute("data-row"),r=this.domNode.getAttribute("data-rowspan"),o=this.domNode.getAttribute("data-colspan");!this.statics.requiredContainer||this.parent instanceof this.statics.requiredContainer||this.wrap(this.statics.requiredContainer.blotName,{row:t,colspan:o,rowspan:r}),super.optimize(e)}tableCell(){return this.parent}}g.blotName="table-cell-line",g.ClassName="qlbt-cell-line",g.tagName="DIV";class y extends c{checkMerge(){if(super.checkMerge()&&null!=this.next.children.head){const e=this.children.head.formats()[this.children.head.statics.blotName],t=this.children.tail.formats()[this.children.tail.statics.blotName],r=this.next.children.head.formats()[this.next.children.head.statics.blotName],o=this.next.children.tail.formats()[this.next.children.tail.statics.blotName];return e.cell===t.cell&&e.cell===r.cell&&e.cell===o.cell}return!1}static create(e){const t=super.create(e);return t.setAttribute("data-row",e.row),f.forEach(r=>{e[r]&&t.setAttribute(r,e[r])}),t}static formats(e){const t={};return e.hasAttribute("data-row")&&(t.row=e.getAttribute("data-row")),f.reduce((t,r)=>(e.hasAttribute(r)&&(t[r]=e.getAttribute(r)),t),t)}cellOffset(){return this.parent?this.parent.children.indexOf(this):-1}formats(){const e={};return this.domNode.hasAttribute("data-row")&&(e.row=this.domNode.getAttribute("data-row")),f.reduce((e,t)=>(this.domNode.hasAttribute(t)&&(e[t]=this.domNode.getAttribute(t)),e),e)}toggleAttribute(e,t){t?this.domNode.setAttribute(e,t):this.domNode.removeAttribute(e)}formatChildren(e,t){this.children.forEach(r=>{r.format(e,t)})}format(e,t){f.indexOf(e)>-1?(this.toggleAttribute(e,t),this.formatChildren(e,t)):["row"].indexOf(e)>-1?(this.toggleAttribute(`data-${e}`,t),this.formatChildren(e,t)):super.format(e,t)}optimize(e){const t=this.domNode.getAttribute("data-row");!this.statics.requiredContainer||this.parent instanceof this.statics.requiredContainer||this.wrap(this.statics.requiredContainer.blotName,{row:t}),super.optimize(e)}row(){return this.parent}rowOffset(){return this.row()?this.row().rowOffset():-1}table(){return this.row()&&this.row().table()}}y.blotName="table",y.tagName="TD";class w extends c{checkMerge(){if(super.checkMerge()&&null!=this.next.children.head){const e=this.children.head.formats(),t=this.children.tail.formats(),r=this.next.children.head.formats(),o=this.next.children.tail.formats();return e.row===t.row&&e.row===r.row&&e.row===o.row}return!1}static create(e){const t=super.create(e);return t.setAttribute("data-row",e.row),t}formats(){return["row"].reduce((e,t)=>(this.domNode.hasAttribute(`data-${t}`)&&(e[t]=this.domNode.getAttribute(`data-${t}`)),e),{})}optimize(e){!this.statics.requiredContainer||this.parent instanceof this.statics.requiredContainer||this.wrap(this.statics.requiredContainer.blotName),this.enforceAllowedChildren(),null!=this.uiNode&&this.uiNode!==this.domNode.firstChild&&this.domNode.insertBefore(this.uiNode,this.domNode.firstChild),this.children.length>0&&null!=this.next&&this.checkMerge()&&(this.next.moveChildren(this),this.next.remove())}rowOffset(){return this.parent?this.parent.children.indexOf(this):-1}table(){return this.parent&&this.parent.parent}}w.blotName="table-row",w.tagName="TR";class x extends c{}x.blotName="table-body",x.tagName="TBODY";class v extends d{static create(e){let t=super.create(e);return u.forEach(r=>{t.setAttribute(`${r}`,e[r]||h[r])}),t}static formats(e){return u.reduce((t,r)=>(e.hasAttribute(`${r}`)&&(t[r]=e.getAttribute(`${r}`)||void 0),t),{})}format(e,t){u.indexOf(e)>-1?this.domNode.setAttribute(`${e}`,t||h[e]):super.format(e,t)}html(){return this.domNode.outerHTML}}v.blotName="table-col",v.tagName="col";class N extends c{}N.blotName="table-col-group",N.tagName="colgroup";class C extends c{static create(){return super.create()}constructor(e,t){super(e,t),this.updateTableWidth()}updateTableWidth(){setTimeout(()=>{const e=this.colGroup();if(!e)return;const t=e.children.reduce((e,t)=>e+=parseInt(t.formats()[v.blotName].width,10),0);this.domNode.style.width=`${t}px`},0)}cells(e){return this.rows().map(t=>t.children.at(e))}colGroup(){return this.children.head}deleteColumns(e,t=[],r){var n=this.descendants(x);const i=o(n,1)[0];if(null==i||null==i.children.head)return;const s=this.descendants(y),a=[],d=[];if(s.forEach(t=>{const o=(0,l.getRelativeRect)(t.domNode.getBoundingClientRect(),r);o.x+m>e.x&&o.x1-m<e.x1?a.push(t):o.x<e.x+m&&o.x1>e.x1-m&&d.push(t)}),a.length===s.length)return this.tableDestroy(),!0;t.forEach(e=>{this.colGroup().children.at(t[0]).remove()}),a.forEach(e=>{e.remove()}),d.forEach(e=>{const r=parseInt(e.formats().colspan,10);parseInt(e.formats().width,10);e.format("colspan",r-t.length)}),this.updateTableWidth()}deleteRow(e,t){var r=this.descendants(x);const n=o(r,1)[0];if(null==n||null==n.children.head)return;const i=this.descendants(y),s=[],a=[],d=[];if(i.forEach(r=>{const o=(0,l.getRelativeRect)(r.domNode.getBoundingClientRect(),t);o.y>e.y-m&&o.y1<e.y1+m?s.push(r):o.y<e.y+m&&o.y1>e.y1-m&&(a.push(r),Math.abs(o.y-e.y)<m&&d.push(r))}),s.length===i.length)return void this.tableDestroy();const c=this.rows().reduce((r,o)=>{let n=(0,l.getRelativeRect)(o.domNode.getBoundingClientRect(),t);return n.y>e.y-m&&n.y1<e.y1+m&&(r+=1),r},0);d.forEach(e=>{const r=(0,l.getRelativeRect)(e.domNode.getBoundingClientRect(),t),o=e.parent.next,n=o.children.reduce((e,o)=>{const n=(0,l.getRelativeRect)(o.domNode.getBoundingClientRect(),t);return Math.abs(r.x1-n.x)<m&&(e=o),e},null);o.insertBefore(e,n),e.format("row",o.formats().row)}),s.forEach(e=>{e.remove()}),a.forEach(e=>{const t=parseInt(e.formats().rowspan,10);e.format("rowspan",t-c)})}tableDestroy(){const e=n.default.find(this.scroll.domNode.parentNode),t=e.getModule("better-table");this.remove(),t.hideTableTools(),e.update(n.default.sources.USER)}insertCell(e,t){const r=E(),o=e.formats().row,n=this.scroll.create(y.blotName,Object.assign({},b,{row:o})),l=this.scroll.create(g.blotName,{row:o,cell:r});n.appendChild(l),t?e.insertBefore(n,t):e.appendChild(n)}insertColumn(e,t,r=!0,n){var i=this.descendants(x);const s=o(i,1)[0];var a=this.descendants(N);const d=o(a,1)[0],c=this.descendants(v);let u=[],h=[],p=[];if(null==s||null==s.children.head)return;this.descendants(y).forEach(t=>{const o=(0,l.getRelativeRect)(t.domNode.getBoundingClientRect(),n);r?Math.abs(o.x1-e.x1)<m?u.push(t):e.x1-o.x>m&&e.x1-o.x1<-m&&h.push(t):Math.abs(o.x-e.x)<m?u.push(t):e.x-o.x>m&&e.x-o.x1<-m&&h.push(t)}),u.forEach(e=>{const t=r?e.next:e,o=E(),n=e.parent,l=n.formats().row,i=e.formats(),s=this.scroll.create(y.blotName,Object.assign({},b,{row:l,rowspan:i.rowspan})),a=this.scroll.create(g.blotName,{row:l,cell:o,rowspan:i.rowspan});s.appendChild(a),t?n.insertBefore(s,t):n.appendChild(s),p.push(s)});const f=this.scroll.create(v.blotName,!0);let w=r?c[t].next:c[t];return w?d.insertBefore(f,w):d.appendChild(f),h.forEach(e=>{const t=e.formats().colspan;e.format("colspan",parseInt(t,10)+1),p.push(e)}),p.sort((e,t)=>{return e.domNode.getBoundingClientRect().y-t.domNode.getBoundingClientRect().y}),this.updateTableWidth(),p}insertRow(e,t,r){var n=this.descendants(x);const i=o(n,1)[0];if(null==i||null==i.children.head)return;const s=this.descendants(y),d=q(),c=this.scroll.create(w.blotName,{row:d});let u=[],h=[],p=[];s.forEach(o=>{const n=(0,l.getRelativeRect)(o.domNode.getBoundingClientRect(),r);t?Math.abs(n.y1-e.y1)<m?u.push(o):e.y1-n.y>m&&e.y1-n.y1<-m&&h.push(o):Math.abs(n.y-e.y)<m?u.push(o):e.y-n.y>m&&e.y-n.y1<-m&&h.push(o)});const f=(e,t)=>{return e.domNode.getBoundingClientRect().x-t.domNode.getBoundingClientRect().x};u.sort(f),u.forEach(e=>{const t=E(),r=e.formats(),o=this.scroll.create(y.blotName,Object.assign({},b,{row:d,colspan:r.colspan})),n=this.scroll.create(g.blotName,{row:d,cell:t,colspan:r.colspan}),l=this.scroll.create(a.blotName);n.appendChild(l),o.appendChild(n),c.appendChild(o),p.push(o)}),h.forEach(e=>{const t=parseInt(e.formats().rowspan,10);e.format("rowspan",t+1),p.push(e)});const v=this.rows().find(o=>{let n=(0,l.getRelativeRect)(o.domNode.getBoundingClientRect(),r);return t?Math.abs(n.y-e.y-e.height)<m:Math.abs(n.y-e.y)<m});return i.insertBefore(c,v),p.sort(f),p}mergeCells(e,t,r,o,n){const l=t.reduce((e,t,n)=>(0!==n?(e&&t.moveChildren(e),t.remove()):(t.format("colspan",o),t.format("rowspan",r),e=t),e),null);let i=l.domNode.getAttribute("data-row"),s=l.children.head.domNode.getAttribute("data-cell");return l.children.forEach(e=>{e.format("cell",s),e.format("row",i),e.format("colspan",o),e.format("rowspan",r)}),l}unmergeCells(e,t){let r={},o=1,n=1;e.forEach(e=>{if(r=e.formats(),o=r.rowspan,(n=r.colspan)>1){let t=e.next,r=e.row();e.format("colspan",1);for(let e=n;e>1;e--)this.insertCell(r,t)}if(o>1){let r=o,i=e.row().next;for(;r>1;){let o=i.children.reduce((r,o)=>{let n=(0,l.getRelativeRect)(e.domNode.getBoundingClientRect(),t),i=(0,l.getRelativeRect)(o.domNode.getBoundingClientRect(),t);return Math.abs(n.x1-i.x)<m&&(r=o),r},null);for(let e=n;e>0;e--)this.insertCell(i,o);r-=1,i=i.next}e.format("rowspan",1)}})}rows(){const e=this.children.tail;return null==e?[]:e.children.map(e=>e)}}C.blotName="table-container",C.className="quill-better-table",C.tagName="TABLE";class T extends c{constructor(e,t){super(e,t);const r=n.default.find(e.domNode.parentNode);t.addEventListener("scroll",e=>{const t=r.getModule("better-table");t.columnTool&&(t.columnTool.domNode.scrollLeft=e.target.scrollLeft),t.tableSelection&&t.tableSelection.selectedTds.length>0&&t.tableSelection.repositionHelpLines()},!1)}}function q(){return`row-${Math.random().toString(36).slice(2,6)}`}function E(){return`cell-${Math.random().toString(36).slice(2,6)}`}T.blotName="table-view",T.className="quill-better-table-wrapper",T.tagName="DIV",T.allowedChildren=[C],C.requiredContainer=T,C.allowedChildren=[x,N],x.requiredContainer=C,x.allowedChildren=[w],w.requiredContainer=x,w.allowedChildren=[y],y.requiredContainer=w,y.allowedChildren=[g,i.default],g.requiredContainer=y,N.allowedChildren=[v],N.requiredContainer=C,v.requiredContainer=N,t.TableCol=v,t.TableColGroup=N,t.TableCellLine=g,t.TableCell=y,t.TableRow=w,t.TableBody=x,t.TableContainer=C,t.TableViewWrapper=T,t.rowId=q,t.cellId=E,t.CELL_IDENTITY_KEYS=p,t.CELL_ATTRIBUTES=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,n=r(0),l=(o=n)&&o.__esModule?o:{default:o},i=r(2);const s=l.default.import("blots/block");class a extends s{static create(e){"string"==typeof e&&(e={value:e});const t=super.create(e.value);return i.CELL_IDENTITY_KEYS.forEach(r=>{e[r]&&t.setAttribute(`data-${r}`,e[r])}),i.CELL_ATTRIBUTES.forEach(r=>{e[r]&&t.setAttribute(`data-${r}`,e[r])}),t}static formats(e){const t={};return t.value=this.tagName.indexOf(e.tagName)+1,i.CELL_ATTRIBUTES.concat(i.CELL_IDENTITY_KEYS).reduce((t,r)=>(e.hasAttribute(`data-${r}`)&&(t[r]=e.getAttribute(`data-${r}`)||void 0),t),t)}format(e,t){var r=a.formats(this.domNode);const o=r.row,n=r.cell,l=r.rowspan,s=r.colspan;e===a.blotName?t?super.format(e,{value:t,row:o,cell:n,rowspan:l,colspan:s}):o?this.replaceWith(i.TableCellLine.blotName,{row:o,cell:n,rowspan:l,colspan:s}):super.format(e,t):super.format(e,t)}optimize(e){var t=a.formats(this.domNode);const r=t.row,o=t.rowspan,n=t.colspan;if(!r||this.parent instanceof i.TableCell||this.wrap(i.TableCell.blotName,{row:r,colspan:n,rowspan:o}),this.enforceAllowedChildren(),null!=this.uiNode&&this.uiNode!==this.domNode.firstChild&&this.domNode.insertBefore(this.uiNode,this.domNode.firstChild),0===this.children.length)if(null!=this.statics.defaultChild){const e=this.scroll.create(this.statics.defaultChild.blotName);this.appendChild(e)}else this.remove();this.cache={}}}a.blotName="header",a.tagName=["H1","H2","H3","H4","H5","H6"],t.default=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],o=!0,n=!1,l=void 0;try{for(var i,s=e[Symbol.iterator]();!(o=(i=s.next()).done)&&(r.push(i.value),!t||r.length!==t);o=!0);}catch(e){n=!0,l=e}finally{try{!o&&s.return&&s.return()}finally{if(n)throw l}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),n=u(r(0)),l=u(r(5)),i=u(r(6)),s=u(r(7)),a=r(8),d=r(2),c=u(r(3));function u(e){return e&&e.__esModule?e:{default:e}}const h=n.default.import("core/module"),p=n.default.import("delta");class f extends h{static register(){n.default.register(d.TableCol,!0),n.default.register(d.TableColGroup,!0),n.default.register(d.TableCellLine,!0),n.default.register(d.TableCell,!0),n.default.register(d.TableRow,!0),n.default.register(d.TableBody,!0),n.default.register(d.TableContainer,!0),n.default.register(d.TableViewWrapper,!0),n.default.register(d.TableViewWrapper,!0),n.default.register("formats/header",c.default,!0)}constructor(e,t){super(e,t),this.quill.root.addEventListener("click",r=>{if(!r.path||r.path.length<=0)return;const o=r.path.filter(e=>e.tagName&&"TABLE"===e.tagName.toUpperCase()&&e.classList.contains("quill-better-table"))[0];if(o){if(this.table===o)return;this.table&&this.hideTableTools(),this.showTableTools(o,e,t)}else this.table&&this.hideTableTools()},!1),this.quill.root.addEventListener("contextmenu",r=>{if(!this.table)return!0;if(r.preventDefault(),!r.path||r.path.length<=0)return;const o=r.path.filter(e=>e.tagName&&"TABLE"===e.tagName.toUpperCase()&&e.classList.contains("quill-better-table"))[0],n=r.path.filter(e=>e.tagName&&"TR"===e.tagName.toUpperCase()&&e.getAttribute("data-row"))[0],l=r.path.filter(e=>e.tagName&&"TD"===e.tagName.toUpperCase()&&e.getAttribute("data-row"))[0];let i=this.tableSelection.selectedTds.map(e=>e.domNode).includes(l);(this.tableSelection.selectedTds.length<=0||!i)&&this.tableSelection.setSelection(l.getBoundingClientRect(),l.getBoundingClientRect()),this.tableOperationMenu&&(this.tableOperationMenu=this.tableOperationMenu.destroy()),o&&(this.tableOperationMenu=new s.default({table:o,row:n,cell:l,left:r.pageX,top:r.pageY},e,t.operationMenu))},!1);e.getModule("keyboard");e.keyboard.addBinding({key:"Backspace"},{},function(e,t){if(0===e.index||this.quill.getLength()<=1)return!0;var r=this.quill.getLine(e.index);const n=o(r,1)[0];if(0===t.offset){var l=this.quill.getLine(e.index-1);const t=o(l,1)[0];if(null!=t&&"table-cell-line"===t.statics.blotName&&"table-cell-line"!==n.statics.blotName)return!1}return!0});let r=e.keyboard.bindings.Backspace.pop();e.keyboard.bindings.Backspace.splice(0,1,r),e.clipboard.addMatcher("td",a.matchTableCell),e.clipboard.addMatcher("th",a.matchTableHeader),e.clipboard.addMatcher("table",a.matchTable),e.clipboard.addMatcher("h1, h2, h3, h4, h5, h6",a.matchHeader),e.clipboard.matchers=e.clipboard.matchers.filter(e=>"tr"!==e[0])}getTable(e=this.quill.getSelection()){if(null==e)return[null,null,null,-1];var t=this.quill.getLine(e.index),r=o(t,2);const n=r[0],l=r[1];if(null==n||n.statics.blotName!==d.TableCellLine.blotName)return[null,null,null,-1];const i=n.tableCell(),s=i.row();return[s.table(),s,i,l]}insertTable(e,t){const r=this.quill.getSelection(!0);if(null==r)return;this.quill.getLeaf(r.index)[0],this.quill.getLeaf(r.index+1)[0];let o=(new p).retain(r.index);o.insert("\n"),o=new Array(t).fill("\n").reduce((e,t)=>(e.insert(t,{"table-col":!0}),e),o),o=new Array(e).fill(0).reduce(e=>{let r=(0,d.rowId)();return new Array(t).fill("\n").reduce((e,t)=>(e.insert(t,{"table-cell-line":{row:r,cell:(0,d.cellId)()}}),e),e)},o),this.quill.updateContents(o,n.default.sources.USER),this.quill.setSelection(r.index+t+1,n.default.sources.API)}showTableTools(e,t,r){this.table=e,this.columnTool=new l.default(e,t,r),this.tableSelection=new i.default(e,t,r)}hideTableTools(){this.columnTool&&this.columnTool.destroy(),this.tableSelection&&this.tableSelection.destroy(),this.tableOperationMenu&&this.tableOperationMenu.destroy(),this.columnTool=null,this.tableSelection=null,this.tableOperationMenu=null,this.table=null}}f.keyboardBindings={"table-cell-line backspace":{key:"Backspace",format:["table-cell-line"],collapsed:!0,offset:0,handler(e,t){var r=this.quill.getLine(e.index),n=o(r,2);const l=n[0];n[1];return!(!l.prev||"table-cell-line"!==l.prev.statics.blotName)}},"table-cell-line delete":{key:"Delete",format:["table-cell-line"],collapsed:!0,suffix:/^$/,handler(){}},"table-cell-line enter":{key:"Enter",shiftKey:null,format:["table-cell-line"],handler(e,t){if(this.quill.selection&&this.quill.selection.composing)return;const r=n.default.imports.parchment.Scope;e.length>0&&this.quill.scroll.deleteAt(e.index,e.length);const o=Object.keys(t.format).reduce((e,o)=>(this.quill.scroll.query(o,r.BLOCK)&&!Array.isArray(t.format[o])&&(e[o]=t.format[o]),e),{});this.quill.insertText(e.index,"\n",o["table-cell-line"],n.default.sources.USER),this.quill.setSelection(e.index+1,n.default.sources.SILENT),this.quill.focus(),Object.keys(t.format).forEach(e=>{null==o[e]&&(Array.isArray(t.format[e])||"link"!==e&&this.quill.format(e,t.format[e],n.default.sources.USER))})}}},t.default=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,n=r(0),l=(o=n)&&o.__esModule?o:{default:o},i=r(1);const s=12,a=12,d=50,c="#35A7ED";t.default=class{constructor(e,t,r){if(!e)return null;this.table=e,this.quill=t,this.options=r,this.domNode=null,this.initColTool()}initColTool(){const e=this.quill.root.parentNode,t=(this.table.getBoundingClientRect(),e.getBoundingClientRect()),r=this.table.parentNode.getBoundingClientRect();this.domNode=document.createElement("div"),this.domNode.classList.add("qlbt-col-tool"),this.updateToolCells(),e.appendChild(this.domNode),(0,i.css)(this.domNode,{width:`${r.width}px`,height:`${s}px`,left:`${r.left-t.left+e.scrollLeft}px`,top:`${r.top-t.top+e.scrollTop-s-5}px`})}createToolCell(){const e=document.createElement("div");e.classList.add("qlbt-col-tool-cell");const t=document.createElement("div");return t.classList.add("qlbt-col-tool-cell-holder"),(0,i.css)(e,{height:`${a}px`}),e.appendChild(t),e}updateToolCells(){const e=l.default.find(this.table),t=e.children.tail.children.head.children,r=e.colGroup().children,o=function(e){return e.reduce((e,t)=>{const r=t.formats().colspan;return e+=parseInt(r,10)},0)}(t);let n=Array.from(this.domNode.querySelectorAll(".qlbt-col-tool-cell"));for(let e=0;e<Math.max(o,n.length);e++){let t=r.at(e),l=t&&parseInt(t.formats()[t.statics.blotName].width,10),s=null;n[e]?n[e]&&e>=o?n[e].remove():(s=n[e],(0,i.css)(s,{"min-width":`${l}px`})):(s=this.createToolCell(),this.domNode.appendChild(s),this.addColCellHolderHandler(s),(0,i.css)(s,{"min-width":`${l}px`}))}}destroy(){return this.domNode.remove(),null}addColCellHolderHandler(e){const t=l.default.find(this.table),r=e.querySelector(".qlbt-col-tool-cell-holder");let o=!1,n=0,a=0,u=0,h=0,p={},f={},b=null;const m=e=>{e.preventDefault(),o&&(a=e.clientX,u=h+a-n>=d?a-n:d-h,(0,i.css)(b,{left:`${f.left+f.width-1+u}px`}))},g=l=>{l.preventDefault();const s=Array.from(this.domNode.querySelectorAll(".qlbt-col-tool-cell")).indexOf(e),d=t.colGroup().children.at(s);o&&(d.format("width",h+u),(0,i.css)(e,{"min-width":`${h+u}px`}),n=0,a=0,u=0,h=0,o=!1,r.classList.remove("dragging")),document.removeEventListener("mousemove",m,!1),document.removeEventListener("mouseup",g,!1),p={},f={},b.remove(),b=null,t.updateTableWidth();const c=this.quill.getModule("better-table").tableSelection;c&&c.clearSelection()};r.addEventListener("mousedown",t=>{document.addEventListener("mousemove",m,!1),document.addEventListener("mouseup",g,!1),p=this.table.getBoundingClientRect(),f=e.getBoundingClientRect(),b=document.createElement("div"),(0,i.css)(b,{position:"fixed",top:`${f.top}px`,left:`${f.left+f.width-1}px`,zIndex:"100",height:`${p.height+s+4}px`,width:"1px",backgroundColor:c}),document.body.appendChild(b),o=!0,n=t.clientX,h=f.width,r.classList.add("dragging")},!1)}colToolCells(){return Array.from(this.domNode.querySelectorAll(".qlbt-col-tool-cell"))}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,n=r(0),l=(o=n)&&o.__esModule?o:{default:o},i=r(1),s=r(2);const a="#35A7ED",d=["left","right","top","bottom"],c=2;function u(e,t){let r=Math.min(e.x,t.x,e.x+e.width-1,t.x+t.width-1),o=Math.max(e.x,t.x,e.x+e.width-1,t.x+t.width-1),n=Math.min(e.y,t.y,e.y+e.height-1,t.y+t.height-1),l=Math.max(e.y,t.y,e.y+e.height-1,t.y+t.height-1);return{x:r,x1:o,y:n,y1:l,width:o-r,height:l-n}}t.default=class{constructor(e,t,r){if(!e)return null;this.table=e,this.quill=t,this.options=r,this.boundary={},this.selectedTds=[],this.dragging=!1,this.selectingHandler=this.mouseDownHandler.bind(this),this.clearSelectionHanler=this.clearSelection.bind(this),this.helpLinesInitial(),this.quill.root.addEventListener("mousedown",this.selectingHandler,!1),this.quill.on("text-change",this.clearSelectionHanler)}helpLinesInitial(){let e=this.quill.root.parentNode;d.forEach(t=>{this[t]=document.createElement("div"),this[t].classList.add("qlbt-selection-line"),(0,i.css)(this[t],{position:"absolute",display:"none","background-color":a}),e.appendChild(this[t])})}mouseDownHandler(e){if(0!==e.button||!e.target.closest(".quill-better-table"))return;this.quill.root.addEventListener("mousemove",n,!1),this.quill.root.addEventListener("mouseup",function e(r){t.quill.root.removeEventListener("mousemove",n,!1),t.quill.root.removeEventListener("mouseup",e,!1),t.dragging=!1},!1);const t=this,r=e.target.closest("td[data-row]"),o=(0,i.getRelativeRect)(r.getBoundingClientRect(),this.quill.root.parentNode);function n(e){if(0!==e.button||!e.target.closest(".quill-better-table"))return;const n=e.target.closest("td[data-row]"),l=(0,i.getRelativeRect)(n.getBoundingClientRect(),t.quill.root.parentNode);t.boundary=u(o,l),t.correctBoundary(),t.selectedTds=t.computeSelectedTds(),t.repositionHelpLines(),r!==n&&t.quill.blur()}this.dragging=!0,this.boundary=u(o,o),this.correctBoundary(),this.selectedTds=this.computeSelectedTds(),this.repositionHelpLines()}correctBoundary(){l.default.find(this.table).descendants(s.TableCell).forEach(e=>{var t=(0,i.getRelativeRect)(e.domNode.getBoundingClientRect(),this.quill.root.parentNode);let r=t.x,o=t.y,n=t.width,l=t.height;(r+c>=this.boundary.x&&r+c<=this.boundary.x1||r-c+n>=this.boundary.x&&r-c+n<=this.boundary.x1)&&(o+c>=this.boundary.y&&o+c<=this.boundary.y1||o-c+l>=this.boundary.y&&o-c+l<=this.boundary.y1)&&(this.boundary=u(this.boundary,{x:r,y:o,width:n,height:l}))})}computeSelectedTds(){return l.default.find(this.table).descendants(s.TableCell).reduce((e,t)=>{var r=(0,i.getRelativeRect)(t.domNode.getBoundingClientRect(),this.quill.root.parentNode);let o=r.x,n=r.y,l=r.width,s=r.height;return o+c>=this.boundary.x&&o-c+l<=this.boundary.x1&&n+c>=this.boundary.y&&n-c+s<=this.boundary.y1&&e.push(t),e},[])}repositionHelpLines(){const e=this.table.parentNode.scrollLeft;(0,i.css)(this.left,{display:"block",left:`${this.boundary.x-e-1}px`,top:`${this.boundary.y}px`,height:`${this.boundary.height+1}px`,width:"1px"}),(0,i.css)(this.right,{display:"block",left:`${this.boundary.x1-e}px`,top:`${this.boundary.y}px`,height:`${this.boundary.height+1}px`,width:"1px"}),(0,i.css)(this.top,{display:"block",left:`${this.boundary.x-1-e}px`,top:`${this.boundary.y}px`,width:`${this.boundary.width+1}px`,height:"1px"}),(0,i.css)(this.bottom,{display:"block",left:`${this.boundary.x-1-e}px`,top:`${this.boundary.y1+1}px`,width:`${this.boundary.width+1}px`,height:"1px"})}refreshHelpLinesPosition(){const e=(0,i.getRelativeRect)(this.selectedTds[0].domNode.getBoundingClientRect(),this.quill.root.parentNode),t=(0,i.getRelativeRect)(this.selectedTds[this.selectedTds.length-1].domNode.getBoundingClientRect(),this.quill.root.parentNode);this.boundary=u(e,t),this.repositionHelpLines()}destroy(){return d.forEach(e=>{this[e].remove(),this[e]=null}),this.quill.root.removeEventListener("mousedown",this.selectingHandler,!1),this.quill.off("text-change",this.clearSelectionHanler),null}setSelection(e,t){this.boundary=u((0,i.getRelativeRect)(e,this.quill.root.parentNode),(0,i.getRelativeRect)(t,this.quill.root.parentNode)),this.correctBoundary(),this.selectedTds=this.computeSelectedTds(),this.repositionHelpLines()}clearSelection(){this.boundary={},this.selectedTds=[],d.forEach(e=>{this[e]&&(0,i.css)(this[e],{display:"none"})})}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,n=r(0),l=(o=n)&&o.__esModule?o:{default:o},i=r(1);const s=150,a=200,d={insertColumnRight:{text:"Insert column right",handler(){const e=l.default.find(this.table);let t=c(this.columnToolCells,this.boundary,(e,t)=>Math.abs(e.x+e.width-t.x1)<=5,this.quill.root.parentNode);const r=e.insertColumn(this.boundary,t,!0,this.quill.root.parentNode);this.tableColumnTool.updateToolCells(),this.quill.update(l.default.sources.USER),this.quill.setSelection(this.quill.getIndex(r[0]),0,l.default.sources.SILENT),this.tableSelection.setSelection(r[0].domNode.getBoundingClientRect(),r[0].domNode.getBoundingClientRect())}},insertColumnLeft:{text:"Insert column left",handler(){const e=l.default.find(this.table);let t=c(this.columnToolCells,this.boundary,(e,t)=>Math.abs(e.x-t.x)<=5,this.quill.root.parentNode);const r=e.insertColumn(this.boundary,t,!1,this.quill.root.parentNode);this.tableColumnTool.updateToolCells(),this.quill.update(l.default.sources.USER),this.quill.setSelection(this.quill.getIndex(r[0]),0,l.default.sources.SILENT),this.tableSelection.setSelection(r[0].domNode.getBoundingClientRect(),r[0].domNode.getBoundingClientRect())}},insertRowUp:{text:"Insert row up",handler(){const e=l.default.find(this.table).insertRow(this.boundary,!1,this.quill.root.parentNode);this.quill.update(l.default.sources.USER),this.quill.setSelection(this.quill.getIndex(e[0]),0,l.default.sources.SILENT),this.tableSelection.setSelection(e[0].domNode.getBoundingClientRect(),e[0].domNode.getBoundingClientRect())}},insertRowDown:{text:"Insert row down",handler(){const e=l.default.find(this.table).insertRow(this.boundary,!0,this.quill.root.parentNode);this.quill.update(l.default.sources.USER),this.quill.setSelection(this.quill.getIndex(e[0]),0,l.default.sources.SILENT),this.tableSelection.setSelection(e[0].domNode.getBoundingClientRect(),e[0].domNode.getBoundingClientRect())}},mergeCells:{text:"Merge selected cells",handler(){const e=l.default.find(this.table),t=e.rows().reduce((e,t)=>{let r=(0,i.getRelativeRect)(t.domNode.getBoundingClientRect(),this.quill.root.parentNode);return r.y>this.boundary.y-5&&r.y+r.height<this.boundary.y+this.boundary.height+5&&(e+=1),e},0),r=this.columnToolCells.reduce((e,t)=>{let r=(0,i.getRelativeRect)(t.getBoundingClientRect(),this.quill.root.parentNode);return r.x>this.boundary.x-5&&r.x+r.width<this.boundary.x+this.boundary.width+5&&(e+=1),e},0),o=e.mergeCells(this.boundary,this.selectedTds,t,r,this.quill.root.parentNode);this.quill.update(l.default.sources.USER),this.tableSelection.setSelection(o.domNode.getBoundingClientRect(),o.domNode.getBoundingClientRect())}},unmergeCells:{text:"Unmerge cells",handler(){l.default.find(this.table).unmergeCells(this.selectedTds,this.quill.root.parentNode),this.quill.update(l.default.sources.USER),this.tableSelection.clearSelection()}},deleteColumn:{text:"Delete selected columns",handler(){const e=l.default.find(this.table);let t=(r=this.columnToolCells,o=this.boundary,n=((e,t)=>e.x+5>t.x&&e.x+e.width-5<t.x1),s=this.quill.root.parentNode,r.reduce((e,t)=>{let l=(0,i.getRelativeRect)(t.getBoundingClientRect(),s);return n(l,o)&&e.push(r.indexOf(t)),e},[]));var r,o,n,s;e.deleteColumns(this.boundary,t,this.quill.root.parentNode)||(this.tableColumnTool.updateToolCells(),this.quill.update(l.default.sources.USER),this.tableSelection.clearSelection())}},deleteRow:{text:"Delete selected rows",handler(){l.default.find(this.table).deleteRow(this.boundary,this.quill.root.parentNode),this.quill.update(l.default.sources.USER),this.tableSelection.clearSelection()}},deleteTable:{text:"Delete table",handler(){const e=this.quill.getModule("better-table"),t=l.default.find(this.table);e.hideTableTools(),t.remove(),this.quill.update(l.default.sources.USER)}}};function c(e,t,r,o){return e.reduce((n,l)=>{let s=(0,i.getRelativeRect)(l.getBoundingClientRect(),o);return r(s,t)&&(n=e.indexOf(l)),n},!1)}t.default=class{constructor(e,t,r){const o=t.getModule("better-table");this.tableSelection=o.tableSelection,this.table=e.table,this.quill=t,this.options=r,this.menuItems=Object.assign({},d,r.items),this.tableColumnTool=o.columnTool,this.boundary=this.tableSelection.boundary,this.selectedTds=this.tableSelection.selectedTds,this.destroyHanlder=this.destroy.bind(this),this.columnToolCells=this.tableColumnTool.colToolCells(),this.menuInitial(e),this.mount(),document.addEventListener("click",this.destroyHanlder,!1)}mount(){document.body.appendChild(this.domNode)}destroy(){return this.domNode.remove(),document.removeEventListener("click",this.destroyHanlder,!1),null}menuInitial({table:e,left:t,top:r}){this.domNode=document.createElement("div"),this.domNode.classList.add("qlbt-operation-menu"),(0,i.css)(this.domNode,{position:"absolute",left:`${t}px`,top:`${r}px`,"min-height":`${s}px`,width:`${a}px`});for(let e in this.menuItems)this.menuItems[e]&&this.domNode.appendChild(this.menuItemCreator(Object.assign({},d[e],this.menuItems[e])))}menuItemCreator({text:e,handler:t}){const r=document.createElement("div");return r.classList.add("qlbt-operation-menu-item"),r.innerText=e,r.addEventListener("click",t.bind(this),!1),r}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.matchTableCell=function(e,t,r){const o=e.parentNode,n="TABLE"===o.parentNode.tagName?o.parentNode:o.parentNode.parentNode,l=Array.from(n.querySelectorAll("tr")),a=Array.from(o.querySelectorAll("td")),d=l.indexOf(o)+1,c=a.indexOf(e)+1,u=e.getAttribute("colspan")||!1,h=e.getAttribute("rowspan")||!1;if(0===t.length())return t=(new s).insert("\n",{"table-cell-line":{row:d,cell:c,rowspan:h,colspan:u}});return(t=t.reduce((e,t)=>{if(t.insert&&"string"==typeof t.insert){const r=[];let o=t.insert,n=0;for(let e=0;e<t.insert.length;e++)"\n"===o.charAt(e)&&(0===e?r.push("\n"):(r.push(o.substring(n,e)),r.push("\n")),n=e+1);const l=o.substring(n);l&&r.push(l),r.forEach(r=>{"\n"===r?e.insert("\n",t.attributes):e.insert(r,(0,i._omit)(t.attributes,["table","table-cell-line","header"]))})}else e.insert(t.insert,t.attributes);return e},new s)).reduce((e,t)=>{if(t.insert&&"string"==typeof t.insert&&t.insert.startsWith("\n")){let r={};t.attributes.header?r.header={row:d,cell:c,rowspan:h,colspan:u}:t.attributes["table-cell-line"]&&(r["table-cell-line"]={row:d,cell:c,rowspan:h,colspan:u}),e.insert(t.insert,Object.assign({},Object.assign({},{row:d},t.attributes.table),r,(0,i._omit)(t.attributes,["table"])))}else e.insert(t.insert,Object.assign({},(0,i._omit)(t.attributes,["table","table-cell-line"])));return console.log(e),e},new s)},t.matchTableHeader=function(e,t,r){const o=e.parentNode,n="TABLE"===o.parentNode.tagName?o.parentNode:o.parentNode.parentNode,l=Array.from(n.querySelectorAll("tr")),a=Array.from(o.querySelectorAll("th")),d=l.indexOf(o)+1,c=a.indexOf(e)+1,u=e.getAttribute("colspan")||!1,h=e.getAttribute("rowspan")||!1;if(0===t.length())return t=(new s).insert("\n",{"table-cell-line":{row:d,cell:c,rowspan:h,colspan:u}});return(t=t.reduce((e,t)=>{if(t.insert&&"string"==typeof t.insert){const r=[];let o=t.insert,n=0;for(let e=0;e<t.insert.length;e++)"\n"===o.charAt(e)&&(0===e?r.push("\n"):(r.push(o.substring(n,e)),r.push("\n")),n=e+1);const l=o.substring(n);l&&r.push(l),r.indexOf("\n")<0&&r.push("\n"),r.forEach(r=>{"\n"===r?e.insert("\n",{"table-cell-line":{row:d,cell:c,rowspan:h,colspan:u}}):e.insert(r,t.attributes)})}else e.insert(t.insert,t.attributes);return e},new s)).reduce((e,t)=>(t.insert&&"string"==typeof t.insert&&t.insert.startsWith("\n")?e.insert(t.insert,Object.assign({},{"table-cell-line":{row:d,cell:c,rowspan:h,colspan:u}})):e.insert(t.insert,Object.assign({},(0,i._omit)(t.attributes,["table","table-cell-line"]))),e),new s)},t.matchTable=function(e,t,r){let o=new s;const n=e.querySelector("tr");if(null===n)return o;const l=Array.from(n.querySelectorAll("td")).concat(Array.from(n.querySelectorAll("th"))).reduce((e,t)=>{const r=t.getAttribute("colspan")||1;return e+=parseInt(r,10)},0),i=e.querySelectorAll("col").length;if(i===l)return t;{for(let e=0;e<l-i;e++)o.insert("\n",{"table-col":!0});if(0===i)return o.concat(t);let e=0;return t.reduce((t,r)=>(t.insert(r.insert,r.attributes),r.attributes&&r.attributes["table-col"]&&(e+=r.insert.length)===i&&(t=t.concat(o)),t),new s)}},t.matchHeader=function(e,t,r){return t};var o,n=r(0),l=(o=n)&&o.__esModule?o:{default:o},i=r(1);const s=l.default.import("delta")},function(e,t,r){},,,function(e,t,r){"use strict";var o,n=r(4),l=(o=n)&&o.__esModule?o:{default:o};r(9),Quill.register({"modules/better-table":l.default},!0),window.onload=(()=>{const e=new Quill("#editor-wrapper",{theme:"snow",modules:{table:!1,"better-table":{operationMenu:{items:{unmergeCells:{text:"Another unmerge cells name"}}}},keyboard:{bindings:l.default.keyboardBindings}}});let t=e.getModule("better-table");document.body.querySelector("#insert-table").onclick=(()=>{t.insertTable(3,3)}),document.body.querySelector("#get-table").onclick=(()=>{console.log(t.getTable())}),document.body.querySelector("#get-contents").onclick=(()=>{console.log(e.getContents())})})}]).default});